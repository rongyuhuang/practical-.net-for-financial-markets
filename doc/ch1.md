# 第一章 权益类市场简介 Introducing the Equities Market
Luck in life always exists in the form of an abstract class that cannot be instantiated directly and
needs to be inherited by hard work and dedication.
This chapter provides a broad overview of the equities market by explaining its fundamental con-
cepts. It does not assume any understanding of financial markets. Our goal is to give you a brief tour
of the trading world. After reading this chapter, you will appreciate the basics of capital markets
(more specifically, the equities market), and you will understand the various entities that come
together to create a marketplace and how trading and settlement take place. As you read this book,
the coverage of markets becomes more detailed. Although all the other chapters cover technical
aspects of markets, this chapter covers only the business aspects of the equities market. The busi-
ness topics covered in this chapter are by themselves a vast subject, and it is nearly impossible to
address every facet of them. Therefore, we will focus on the entities and basic workflow involved in
the trading and settlement business.
What Is a Capital Market?
A capital market is the part of a financial market where companies in need of capital come forward
and look for people to invest in them in search of returns. Companies raise money either through
bonds or through stocks. Bonds are issued against an interest-bearing loan that the company takes.
The loan assures that bondholders will get periodic interest payments, which are more or less guar-
anteed by the company that issues the bonds. Investors who are risk averse or who want to diversify
their portfolios in safer areas invest in bonds. Stocks do not assure periodic payments like bonds do.
Hence, stocks are considered riskier than bonds. Companies raise money to fund a new venture, an
existing operation, or a new takeover; to purchase new equipment; to open new facilities; to expand
into new markets; to launch new products; and so on. Companies list their stocks on stock exchanges
to create a market for them and to allow their shares to be traded subsequently. (We discuss listings
in more detail in a moment.) Sometimes companies can issue stocks even when the company is not
listed but has the intention of getting listed.
■Note Stocks of companies are also popularly called scrips, instruments, and securities.
12C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
Sometimes a company directly approaches a market in search of investors and issues securities.
The company hooks up with agencies called lead managers, or merchant bankers, that help the com-
pany raise money. In cases where investors are directly providing money to companies, the process
is called a public offering. If it’s the first time the company is raising money from the public, the process is
called an initial public offering (IPO). A market where a public offering is made and companies
raise money directly from investors is called a primary market.
Once the public offering takes place, investors have the securities, and the company has the
money. The company then lists the securities on one or multiple stock exchanges. Companies apply
to the exchange to get their stocks listed. They pay a listing fee to the exchange for listing and comply
with the exchange’s specified listing requirements. Listing makes the securities available for subse-
quent buying and selling through current and potential investors. This enables investors to make
profits, cut risks, invest in potential growth areas, and so on. A market where shares are subsequently
traded after issuance is called a secondary market.
What Is Equity, and What Are Equity Shares?
Equity is the capital that is deployed to start a company. It has all the risk and gives a share in the
profit that the corporation makes. Equity shares are instruments that grant ownership on equity and
thus the underlying company. Shareholders are owners of a company. Their ownership is proportional
to the percentage of shares held in the company. Usually shareholders and managers of the company
are different, but they can also be the same. Shareholders appoint the company’s board and chief
executive officers (CEOs). The company makes profits and losses in the usual course of its business.
The profit that the company makes is distributed amongst the shareholders in proportion to the
number of shares they hold. The profit shared with shareholders is a dividend. When the company
incurs a loss, no dividend is paid, and shareholders have to wait for a better year that brings in profits.
Owning stocks has some other benefits. If you buy stocks at an attractive price in a profit-making
company, chances are you will witness capital appreciation as stock prices rise. Prices rise because
people are willing to pay higher prices in anticipation of an increase in a company’s profit. Simply
put, these shares are not merely pieces of paper—they have real companies behind them. When the
fortunes of these companies improve because of improved business conditions or an increase in the
demands of a company’s products, the value of shares representing the company also rises, resulting
in profits for shareholders. However, during times of losses, the share prices can decline; and at times
these declines can be substantial. These declines can hurt shareholders by eroding their holding values.
Buying and holding shares thus requires patience, insight, and risk-taking ability on the part of the
shareholder.
When a company whose securities are traded on a stock exchange tries to issue stock, its already
prevailing prices determine how much money the company can raise per share for its fresh issue.
Investors and researchers do an inherent valuation of the company’s stock to arrive at the price the
shares will trade at after the stock issue and then, depending on the offer price, invest accordingly.
A company whose offer price is lower than the intrinsic value will receive a good response in terms
of investor participation, and a company whose offer price is at a premium will receive a lukewarm
response.
This form of financing is not available to sole proprietorships and partnerships.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 3
Why Do People Trade?
Several entities—such as banks, mutual funds, pension funds, brokering firms, insurance compa-
nies, corporations, and individuals who possess resources for investments—classify as investors, or
traders. Throughout the book, we will use the words investors, traders, and dealers interchangeably
because they are more or less the same. They access the markets with a motive of making profits;
the differences are in their approaches, frequency of trading, and aggression of trading. Although
dealers and traders are the same, the term investor implies people who are a tad risk averse and
whose trading frequency is less. Investors usually remain with a specific position for a longer term
than dealers/traders. We will ignore these differences, however, because these are general distinctions.
Investors trade to invest in an asset class, to speculate, or to hedge their risks. Investors trade with an
objective of profiting from the transaction by buying and holding securities in the case of rising prices
and by selling and protecting themselves from price declines in the case of a falling market.
Trading is a two-person, zero-sum game. In each transaction, one party makes money, and the
other loses money. Since the prices of shares or any asset traded is bidirectional, you generally have
a 50 percent chance of making a profit and a 50 percent chance of losing money. Traders know this,
yet they trade. This is because they have a price and value forecast/view of the security that they
believe is correct, and they want to profit from the view.
Transactions are normally driven by two factors:
Information: The purchaser/seller genuinely thinks the prices will go up/down. This under-
standing is usually backed by some commercial development, news, research, or belief. An
asset is undervalued when the ongoing market price is less than the intrinsic worth of the asset
and overvalued when the ongoing market price is higher than the intrinsic worth.
Buyers buy and hold securities because they think prices will go up. This simple strategy is called
going long, and this position is called a long position. Buyers of securities may or may not have
the money to finance their purchases. Buyers who don’t have the money to pay can look out for
financing their positions. Similarly, investors sell securities if they anticipate a price decline.
They usually sell and deliver securities to the buyer. However, certain categories of sellers sell but
don’t have the securities to deliver. These types of sellers are called short sellers, and this position
is called a short position. Short sellers either close out their position by accepting profit/loss
or look for a securities lender to lend them securities so they can meet their delivery obligations.
Liquidity: Holders of securities know they need to hold securities longer in order to make
a reasonable profit but are unable to hold them because they need money urgently for some
other reason. Traders keep shuffling between assets in search of superior returns. If they know
one particular security gives them a better opportunity to earn, they might liquidate investments
made in another security even if their investment objective in that particular security has not
matured. Such transactions are liquidity-driven transactions. Even when traders are not shuffling
between asset classes, they may be forced to liquidate positions simply because they have mone-
tary obligations that they can no longer postpone.
It is not difficult to visualize that most trades happen because of differences in opinion about
a stock’s price (see Figure 1-1). Therefore, the value of securities fluctuates from time to time. Buyers
are thinking a particular security has a potential upside, and sellers are thinking the opposite. In
certain extreme conditions, no difference in opinion exists. In such cases, markets really become
illiquid, and it becomes difficult to push through transactions. One such example was the condition
of stock markets worldwide after the September 11 disaster.4C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
Although traders knew for certain there would be value erosion in most securities because of the
loss and resultant slowdown in the economy, they did not agree on the quantum, and no one was
even willing to hazard a guess. More specifically, no one knew what the economic impact would be
on the share prices of companies and at what levels prices would stagnant. Security prices went into
a free fall. While prices fell, the entire market was of the view that prices should fall; hence, no differ-
ence of opinion existed, and therefore no buyers existed. Buyers surfaced only after a large fall. At
these levels, potential buyers were convinced they were once again getting value for their money;
hence, they became counterparties to sale transactions, and that is when transactions started hap-
pening. Such conditions of market stress directly impact liquidity.
Liquidity is the ease at which you can trade a particular asset. When traders demand liquidity,
they expect their transactions to be executed immediately. Liquidity is also determined by market
width, which is the cost of executing the transaction of a specified size, and by market depth, which
is how much quantity can be executed at a given cost. In markets where securities are relatively
illiquid, possibilities exist that the market is willing to bet on only one side; that is, either the players
are willing only to buy or only to sell. Even when two-way quotes exist, the depth could be small.
This means not enough orders could be in the system to match a large order. This will make traders
go through an agonizing wait if not enough takers exist for their orders. This is a condition most
traders/investors abhor. In fact, large investors are known to avoid stocks that are illiquid.
Traders go long on a stock they think will go up in price. Such traders are called bullish on the
stock. Similarly, traders go short on stocks they think will decline in price. Such traders are called
bearish on the stock. At any given time, a trader could be bullish on one stock while being bearish
on another. Or, even for a particular stock, the trader could be bullish at a particular price and bear-
ish at another price. To see the price at which a security is trading, traders need to refer to a quote.
A quote could be a purchase price or a sale price. It could also be a two-way quote. A two-way
quote comprises a bid price (the purchase price) and an offer price (the sale price). The bid price is
the price a counterparty is willing to pay you in case you want to sell your securities to that party.
The offer price is the price the party is asking for in case you want to buy securities from that party.
The offer price will logically be higher than the bid price. When you ask for a quote, for example,
you will get a figure such as $54.10/$54.15 (see Figure 1-2).
Figure 1-1. Trades happen because of differences in opinion.
Figure 1-2. Two-way quote comprising bid price and offer priceC H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 5
In a two-way quote, the first price is the bid price. In other words, $54.10 is the price you will
get if you want to sell your securities; the condition is called hitting the bid. If you want to buy, the
trader will sell that security to you for $54.15. This is called taking the offer. The difference between
the bid price and offer price is called the spread. The spread is the profit the trader makes by provid-
ing a two-way quote and doing a round-turn transaction (both buy and sell) at that quote. In this
example, the spread is $0.05. Spread is thus a profit for the quote-providing trader and a cost for the
investor.
Some traders also do arbitrage. Arbitrage is buying a stock (or any asset) from a market where
its quote is cheaper and selling it in a different market simultaneously where its quote is at a higher
rate. Though it sounds simple, arbitrage has its own nuances and risks. We will discuss the arbitrage
business in more detail in Chapter 8.
Understanding Entities in the Equities Market
Generally, you can divide an entire market into a buy side and a sell side (see Figure 1-3). The buy
side includes fund managers, institutions, individual investors, corporations, and governments that
are looking for investment avenues and solutions to issues they face. For example, corporations
could be looking to issue fresh equity and thus be looking for investors. Corporations could also be
hedging their existing exposure. This means they would be buying or selling some assets to cut risk
they are already facing. Fund managers could be looking for avenues to park their funds to provide
returns to their unit holders. Portfolio managers play a similar role and could be looking for oppor-
tunities to sell and make profits.
The sell side includes entities that provide liquidity services and solutions to the buy side. Examples
of sell-side entities include stock exchanges, clearing corporations, and depositories. Fund managers
and portfolio managers could trade on an exchange and settle their transactions through clearing
corporations. Corporations could access the market’s issuance mechanism to raise money. In short,
the sell side comes forward to provide services to the buy side.
The equity market comprises a lot of entities, including stock exchanges, clearing corporations,
clearing members, members of the exchange, depositories, banks, and so on. In the subsequent
sections, we will describe the roles played by individual entities in the equities market.
Figure 1-3. Markets can be divided into a buy side and a sell side. Banks are both investors and settlement
facilitators and hence appear on both sides.Stock Exchanges
Stock exchanges are organized markets for buying and selling securities. These securities include
bonds, stocks, and derivative instruments such as options and futures. Because stock exchanges are
one of the most important entities in a capital market, this section discusses them in more detail.
A stock exchange provides players with a platform where transactions can take place. The function
of a stock exchange is to bring all the buyers and sellers together in order to minimize transaction
costs, which are a reality of life and have to be incurred by traders and investors. Apart from obvious
costs such as commissions, taxes, and statutory levies, other costs such as spreads, impact costs, and
search costs are built into the transaction costs.
We have explained spread as a round-turn cost. It is the cost you will incur if you buy some shares
and sell them immediately. Exchanges minimize spreads by taking steps to improve the overall
liquidity in stocks. Since exchanges bring all the participants interested in a security together, liquidity
improves dramatically. Traders now compete with each other to buy and sell securities, and rates
become realistic. The better the rates become, the narrower the spread becomes.
Impact cost is the cost incurred when someone is trying to push a large trade or when an informed
trader wants to deal with someone in particular. Counterparties become suspicious when a large
order is pushed through, especially when someone known to be an informed trader pushes it. For
such orders, they don’t want to transact at the prevailing price and want to include a risk premium.
The counterparty is thus subjected to a different price immediately, which is inferior to the ongoing
price. This difference becomes an impact cost.
Bringing buyers and sellers together reduces the search cost dramatically. Assume, for example,
that you want to buy a secondhand car. Usually, people who want to sell their cars put an advertisement
in the classifieds column of a newspaper. Potential buyers read this listing and contact the sellers.
When the basic price details and requirements match, they travel to meet face to face, inspect the
car, and sometimes get a mechanic to do an appraisal. They negotiate the rates and other terms,
and then the sale takes place. This entire process takes a couple of days to a week’s time. Such
secondhand car markets are relatively illiquid. To improve liquidity in such a market, some second-
hand car dealers organize sales where they request all sellers to display their cars in a fair. They also
organize such meetings online. Potential buyers then visit the area (or log on to the Internet) and
negotiate terms there and then. They also feel comfortable because they can compare all offers
simultaneously. Suddenly, liquidity increases. Such markets have a potential of doing a lot more
transactions in the same time frame, which benefits the buyers and the sellers. Both incur fewer costs
in doing the deal, and both get the best possible price. Thus, getting buyers and sellers together
improves liquidity, reduces search costs, and increases the confidence of the participants. A stock
exchange performs precisely this function.
Stock exchanges worldwide are going through a lot of transformation. You probably remember
seeing television footage of a typical stock exchange where thousands of traders shout in order to
place orders. Since an exchange’s trading floor is a big area and the number of traders is large, how
could it then be possible or at least easy for people to find interested counterparties in a particular
security? What if one trader wanted to transact on a security that is not so popular? It wouldn’t be
easy to find a counterparty.
In reality, an exchange floor has areas earmarked for each security. Traders desirous to trade
a certain security have to go to the area demarcated for that security and find counterparties. What
you usually see on television is traders shouting their bids or offer prices for a particular security.
Others listen to their prices and commit to transactions when they hear favorable prices. Once
a transaction is committed, it is immediately recorded manually so that it is honored later even when
prices turn against one of the parties.
■Note To cut down on shouting, traders devised methods of negotiating by using actions through their fingers
and palms. This method of trading is, however, fraught with a lot of lacunae.
6C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E TC H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 7
Stock exchanges usually never accept orders directly from investors; instead, order requests are
directed to exchanges via brokers. A broker is a member of an exchange who acts as an intermediate
agent between an investor and the exchange. (We will discuss brokers in the “Members of the Exchange”
section.) We will use the words broker and member interchangeably because they both refer to members
of a stock exchange. To place an order, investors have to call/meet their brokers or brokers’ agents
and dictate their orders. (A broker’s agent would forward the order to the broker.) The broker would
then go or send a representative to the floor of the exchange to execute the order. Once the execution
is done, the investor is informed about the execution. In the past, it was not unusual for the broker
to club (aggregate) the order from various investors in a common security while going to get it executed.
This execution could have then happened in multiple fills at different prices. Brokers then decided
which price to pass on to which investor. Investors had no mechanism to know whether the purchase/
sale price being passed to them by their brokers was correct and meant for them. This area was
ambiguous and fraught with manipulation. In less-advanced financial markets, brokers would
normally pass on purchase requests from customers at the highest price of the day and pass on sale
transactions at the lowest price of the share on that day. Brokers would pocket the difference between
the highest/lowest price and actual purchase/sale prices. This became a good form of earning for the
brokers, and in many cases, income from this was even higher than the commissions they earned.
With the advancement of technology and expectation of markets came the desire to reduce
dependency on such traders and bring about transparency in the entire trading process. When you
have a huge nation with vibrant retail participation, the potential number of orders that hit the exchange
is large. It becomes virtually impossible for brokers to do justice to individual investors, which in turn
affects the quality and price of execution and raises a lot of ethics-related issues. This problem gave
birth to screen-based trading.
Most advanced nations have adopted screen-based trading. All the crowded and noisy
exchanges are a thing of past now in most countries. All brokers are connected electronically to
their exchanges through their trading terminals. Brokers can see every order that hits the exchange
on their trading terminals and can bid or offer shares for an order by entering their corresponding
buy/sell orders. These trading terminals are installed at the brokers’ offices, thereby dramatically
increasing the reach of exchanges to the common trading public. This virtually brings the exchange
to an investor’s doorstep. In some countries, investors connect to the exchange directly by trading
software provided by their brokers. Their orders are first routed to the broker’s surveillance system,
which conducts the necessary risk management checks and then routes the order to the exchange
for execution.
The screen-based trading system has many advantages over the traditional system. First, the
process of trading has a lot of transparency. Traders know the exact prices at which their transactions
go through. They also can access the exchange’s order books (with, of course, certain restrictions)
and know the touchline prices, which are the last transacted prices. Access to the order books also
helps traders know the best bid and offer rates prevailing in the markets. This means they know at
what prices their next orders are likely to be transacted.
Second, trading systems have broken geographical barriers and reduced communication costs
drastically. In the earlier model, a lot of trading was centered in large cities that had a physical pres-
ence of a stock exchange. Investors from other cities were required to hook up with representatives
of members of these exchanges, and the order flow used to happen on the phone. A large number of
orders used to miss out or sometimes used to get transacted on a security different from what the
investor had demanded. Many exchanges still prefer floor-based trading because dealers see their
counterparties in person and decide immediately whether they are more informed or less informed
than them and whether trading with them will prove profitable. In adverse cases, dealers get an
opportunity to revise their quotes to suit themselves.
Exchanges provide fair access to all members, and members expect that their orders will be
executed in a fair manner without bias. Automated trading provides them with comfort because
computers behave the way they have been programmed without any bias. Exchanges are usually
open between fixed times during the day, and they allow all members to log in and trade during thistime. This time slot is called the trading session. Most exchanges allow order entry even before the
trading session in a session called the pre-opening session. This session is a slot of about 15 to 20
minutes before the trading session commences. Members are allowed to enter orders in this session,
but the orders don’t get transacted. Exchanges arrive at the fair opening prices of all scrips by getting
a feel of prices contained in the orders for all securities. This is also useful because it prevents the
exchange system from being burdened by a huge number of orders being entered when the trading
starts. Trading stops at a designated time. Exchanges are particular about timing because even a few
seconds’ deviation could benefit some members at the cost of others.
Historically, most exchanges worldwide were nonprofit organizations owned by their members.
This ownership structure has continued for more than a century now. This, however, raised a lot of
governance issues in many countries because members made policies suiting them at the cost of
their clients. Clients started shying away from such exchanges, and liquidity shifted to other exchanges
that had better and more transparent ownership and management structures.
Many exchanges are now trying to de-link ownership and membership on the lines of profes-
sionally managed companies. They are now offering shares to institutions and listing those shares on
the same/multiple exchanges. Once a share is listed on an exchange, the exchange and its functioning,
fundamentals, and financials become the subject of public scrutiny. This form of change is called the
demutualization of the exchange. Exchanges make money from charging listing fees, membership fees,
and transaction charges and by selling market data. Market data is trading- and settlement-related
data and is used by most market participants who base their trading decisions on this information.
(We will cover market data and its importance in the trading business in Chapter 4.) Apart from
exchanges, brokers get data from a variety of sources, including depositories, clearing corporations,
and third-party agencies such as Reuters, Bloomberg, and internal data repositories. (We discuss the
various kinds of data required for trading activities and related issues in Chapter 3.)
The New York Stock Exchange (NYSE) and the American Stock Exchange (AMEX) are the major
stock exchanges in the United States; both are located in New York City. Some regional stock exchanges
operate in Boston, Cincinnati, Chicago, Los Angeles, Miami, Philadelphia, Salt Lake City, San Francisco,
and Spokane. In addition, most of the world’s developed nations have stock exchanges. The larger
and more successful international exchanges are in London, Paris, Hong Kong, Singapore, Australia,
Toronto, and Tokyo. Another major market in the United States is the NASDAQ stock market (formerly
known as the National Association of Securities Dealers Automated Quotation system). The European
Association of Securities Dealers Automated Quotation system (EASDAQ) is the major market for
the European Union (EU). NASDAQ is a major shareholder in EASDAQ.
Members of the Exchange
Members of the exchange are also called brokers. On the NYSE today, two kinds of brokers exist:
floor brokers and specialists.
Floor Brokers
Floor brokers act as agents of their customers and buy and sell on their customers’ behalf and for
the organizations for which they work (see Figure 1-4). It is mandatory for clients to access the
exchange only through designated brokers. Clients cannot do trades otherwise. Brokers solicit busi-
ness from clients, get their orders to the exchange, and match them on the exchange’s matching
system. They also settle their clients’ trades. Some even get the orders matched outside the system,
but most countries have a regulation that trades resulting from such orders be reported immediately
to the exchange system for the entire market to know.
8C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E TC H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 9
Clients specify which security they want to trade and under what conditions. Some clients want
to trade immediately regardless of the prevailing price. Some are willing to wait the entire day for
a good price, and some are willing to wait for several days for a favorable price. These restrictions
are explained to the brokers, and the brokers try to arrange trades accordingly. These conditions can
be captured gracefully in order attributes, or order terms. (We cover various attributes associated with
orders in Chapter 2.)
Though clients pay commissions to floor traders to get their transactions executed, they get a lot
of benefits indirectly. Brokers have access to an exchange’s order-matching system where they execute
orders at competitive prices. They undertake the responsibility of clearing and settling those trades
in a hassle-free, standardized, transparent method. In addition, brokers are generally better informed
than their customers. Sometimes their advice can be valuable. Professional brokers, however, con-
centrate only on brokering and refrain from giving advice. They normally execute what their clients
instruct. Some brokers give advice as a value-added service but don’t accept any liability for that
advice not materializing. Brokers also extend a credit facility to customers in need who have a good
reputation with the broker. They execute the orders on behalf of the customer first and collect money
from the customer later. In many markets, brokers extend a similar facility through banks. This is
called margin trading.
Brokers also execute transactions on their own accounts through house accounts. Profits and
losses from these trades accrue to the broker and not to any client. Such transactions are called
principal transactions. Floor brokers thus perform the role of agents as well as principals. Acting as
an agent as well as a principal becomes an ethical issue and is a cause of key concern in many mar-
kets, especially in those markets that are not very advanced. When brokers buy the same security
for themselves that they also buy for their customers, how can the customers be sure brokers are
passing on transacted prices to them?
For example, assume a stock has moved from $40 to $42 during a trading session. A client has
placed an order to buy this stock at $41. Assume that the broker also has interest in this stock and
wants to purchase at roughly the same rate. When the broker goes to the floor to trade, the broker
executes two buy orders. One gets filled at $41, and the other gets filled at $40.75. Now it’s a tough
decision for the broker. If the broker has not segregated the order initially before executing, he will
not know which one to pass on to his customer and which one to keep for himself. If he passes on
the lot executed at $40.75, he keeps the customer happy but loses money (it’s still debatable whether
this money was his to begin with), and if he passes the execution of $41, then it’s an ethics issue.
Automated trading systems have a neat method of solving this problem. At an order level, the bro-
ker has to specify whether the order is meant for the customer or for his own account. If it’s for the
customer, the broker also has to specify the client code of the customer. The code is required so the
broker does not pass on an execution meant for one customer to another.
Figure 1-4. Brokers help investors access the pool of liquidity that is otherwise not available to investors.
www.allitebooks.com10C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
Dishonest brokers also do front running. When they receive a large order from an informed
investor, they first trade on their own accounts in the same security and build up a similar interest
as the client wants to build up, and then they trade for the client. In this case, the client builds the
position she desires, but she may be saddled with relatively inferior prices as compared to the bro-
ker who traded before the client and thereby put his own interest ahead of the client’s. Front running
is a punishable offense.
Many brokers also solicit business through Internet trading sites where customers who want to
trade log on and place their orders. These brokers are also floor traders.
Specialists
Specialists are a second category of brokers; they provide two-way quotes and execute orders for
floor brokers (see Figure 1-5). They are also called market makers for their designated securities and
maintain their own inventories of shares (for which they are specialists). They will buy from anyone
who wants to sell and sell to anyone who wants to buy. They are key liquidity providers. Designated
market makers exist in many securities in many markets. They provide liquidity to anyone who wants
to buy/sell in the absence of other counterparties. Specialists wait for others to trade with them. Thus,
they are brokers who will be always willing to act as counterparties to anyone who wants to buy or
sell. Anyone who wants to transact with such specialists will ask for a quote. Since they don’t initiate
transactions, they have to be extra careful about the rates at which they choose to transact.
Specialists normally provide a two-way quote. Depending upon the quote, traders decide
whether to trade immediately or wait for a more favorable price to be quoted. Depending upon
a quote, a trader may also decide whether to buy or sell at that particular price. While providing
a two-way quote, specialists don’t really know whether the trader wants to buy from him or sell to
him. Actually, it does not make much of a difference to them because they earn through spreads and
through price changes on the inventories of shares they maintain (provided the quantity is small
and the counterparty is less informed). When specialists want to trade aggressively, they narrow the
spread by bringing the bid price and offer price closer to each other. When they want to be cautious
and want to discourage others from trading, they widen the spread. This increases the cost of doing
a round-turn transaction for other traders, and it discourages others from trading with specialists.
Note that liquidity in most securities is high, and adjusting the bid/offer rates even by a couple of
cents creates a large difference in the demand and supply. Millions of shares can be bought or sold
in a matter of seconds.
The quotes provided by specialists are often referred to as firm or soft. A firm quote is a quote that,
once provided, cannot be changed. When a specialist provides a quote to any trader, the specialist
becomes liable to trade with the trader at that particular price should the trader so desire. On the
other hand, the specialist can modify a soft quote once the trader wants to transact. After giving
Figure 1-5. Specialists provide quotes on request and give others the option to trade with them.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 11
a soft quote, a specialist can also refuse to transact with the trader. Specialists are generally wary of
transacting with traders who potentially know more than them. This apprehension is obvious—if an
owner of a company is trying to sell a large block of her own company’s shares and it is known that
the transaction is not liquidity driven, it is obvious that she thinks her company’s stock is fully valued
and that chances of further appreciation are rare. People who are more informed than the specialists
are normally those who have an insider view of the company. If specialists are wary that they will lose
out financially to the trader if they enter into the trade, they are likely to back out before transacting
or at least modify the quote to suit them. People who know about corporate developments and trade
to profit from them before the news comes out in the public domain are called insiders. Insider
trading is an offense and is punishable in all markets.
A specialist’s business is interesting as well as important for the overall market. They help in the
price discovery process and help the market reach an equilibrium position. During times of market
stress, they provide necessary liquidity, thereby giving opportunity to others to invest/exit. They are
generally better informed about the security than other traders. Depending upon the urgency of
other traders, the outlook of the company behind the security, and the overall market conditions,
specialists determine the bid and offer prices. Needless to say, just like other traders, they like to
keep a larger inventory of shares when the prices are looking up and want to cut their inventories
when the prices seem to be going down. The size of the inventory that they maintain largely depends
upon the bid and offer rates they are quoting.
Since all other traders looking for liquidity want to transact with specialists, a high offer price
from a specialist will tempt traders to sell their holdings to the specialist. This in turn will increase
the inventory size the specialist is holding. A price rise will then benefit the specialist. Conversely,
when the outlook is grim and the specialist wants to offload inventory, the specialist will revise the
prices and quote a lower offer price. This will tempt other traders to buy shares from the specialist
at the lower price. The specialist will then manage to offload his position in favor of other traders.
Thus, you have seen how specialists trade on both the buy side and the sell side and how they
attract and regulate liquidity by adjusting the bid and offer prices. At a particular level of inventory,
however, they would want to maintain a constant stock. In such cases, they quote bid and offer prices
in such a way that the rate at which other traders sell to them matches the rate at which other traders
buy from them, and at this point demand for that stock equals the supply available. This position is
called an equilibrium position, and this price is called the equilibrium price.
Becoming a Member
Through this entire discussion, it would seem that brokers are individuals. Some of them are. However,
brokering as a business requires tremendous power and operational and marketing strength. Most
members (brokers) are thus institutions. Even individuals who hold membership rights maintain
a corporate structure and employ people who run the entire business for them. So, are the members
the same people who you see trading on the exchange floor? Maybe, but in most cases they are not.
They are member representatives who are authorized by the members to trade for them.
Large institutions and traders prefer to become members themselves to protect their interests and
have better control over the entire trading and settlement process. In case volumes of their proprietary
transactions are very high, they save good money that would have otherwise been spent on commissions.
To become an exchange member, a trader or an institution must acquire a membership in the
exchange. Each exchange has a different set of norms and requirements. Indeed, having a member-
ship in any renowned exchange is a matter of prestige. In most exchanges, memberships can be bought
and sold like any stock. The cost at which membership can be acquired fluctuates and is a function
of the demand and supply of memberships. However, money alone cannot buy membership. Most
exchanges have strict screening criteria, and the candidates have to demonstrate a good understanding
of the securities business, a commitment to their customers, and financial integrity. Membership
on the NYSE is called a seat because in the earlier years of its existence, members had to sit in
assigned seats during roll calls. In December 2005, two seats sold on the NYSE for $3,500,000 each.
71faaa86f01e1350c2e3f80cf3a26d1412C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
The highest price paid for a membership in the history of the NYSE was $4,000,000 in December 2005.
As of December 15, 2005, the NYSE had 1,366 members.
Although some exchanges do not issue fresh memberships easily (thereby forcing potential
members to buy from existing members), some exchanges offer memberships on a tap basis. This
means that anyone wanting a membership can approach the exchange anytime and complete the
necessary formalities to become a member.
Indexes
Though an index is not a real entity, any discussion of the equities market cannot be complete
without a discussion of indexes. The movement of indexes has now become synonymous with the
movement of markets and stocks. An index’s price is undoubtedly the most sought after number or
piece of information by traders, investors, researchers, and so on. Investors and researchers do a lot
of analysis to predict where an index is headed and what its direction means to each market participant.
Basically, an index is a measure of relative values. When discussed in equities market parlance,
changes in an index measure changes in market values and hence the market capitalization of
underlying securities. If someone says, “stock prices rose” or “the market was up,” they’re generally
referring to an index. A stock index is built on a specific group of stocks. Whether its value is up or
down reflects the combined price movements of all the stocks in the index.
Indexes are created and maintained by exchanges normally through an index committee.
However, several popular indexes are created and maintained by external companies, agencies,
and newspaper houses.
Widely cited indexes include the following:
  The Dow Jones Industrial Average (DJIA) tracks stock prices of 30 major companies.
  Standard & Poor’s 500, commonly referred to as the S&P 500, combines the stock prices of
500 large companies.
  The NYSE Composite Index includes all common stocks traded on the NYSE.
Apart from miming trends in the market, indexes provide investors with a cheaper method of
creating interest in a market. Most popular indexes are heavily traded, and they enjoy extremely
good liquidity. The impact cost of trading in these indexes is low, and they enjoy good spreads. Indexes
are also not bound by the limitation of availability as compared to corporate stocks. (Corporate stocks
are finite in number; indexes are not finite because they are just numbers.) All these factors make
indexes a desirable product on which to trade. You can track indexes through an index fund or through
index options and futures. Some investors prefer taking a position in an index itself rather than
investing in individual securities. Mutual fund managers build a position in indexes to hedge their
positions in stocks.
Suppose a fund manager holds $10 billion worth of securities in a portfolio. Also assume that
the fund manager expects the market to fall in the medium term by 10 percent. Assuming that the
securities in the portfolio are perfectly correlated with the market and the market actually falls by
10 percent, the portfolio should also see an erosion of about 10 percent. Now the fund manager
faces a strange situation. Although she knows the market will fall, she cannot go ahead and sell indi-
vidual securities because if she sells them individually, their prices would fall anyway because of
impact. Since impact cost is much less in an index than in individual securities, the fund manager
can go short (sell) on the index. Now if the market actually declines, the fund manager will lose money
on the portfolio but will buy back the index she short sold and make money on her short position
on the index. If the quantum of index that is sold short is calculated scientifically, the losses on the
portfolio of stocks will be more or less covered by the profit on the index position. Indexes thus pro-
vide an inexpensive but potent way of eliminating portfolio risk.
We will now show how a basic index is computed and what it means when someone says that
“the index has gone up by 100 points.” As discussed earlier, an index is a relative measure. But what
does it measure, and what does it mean?C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 13
Market capitalization measures the total current replacement value of a company. In other
words, it is the price you would have to pay if you wanted to buy out the company fully (with the
assumption that the prices would not rise with the buying, an unlikely case). In other words, it also
indicates the amount of money it would take if someone decided to create an exact replica of the
company with the same products, manufacturing, and distribution capabilities and the same brand
value (in an environment where the first company is absent so the two don’t compete with each other).
Market capitalization is measured by multiplying the total number of outstanding shares that
the company has issued by its current market price:
Market capitalization = Total number of outstanding shares * Current market price
While constructing any index, some stocks from industries that best represent the economy are
selected for inclusion in the index. These stocks are the best representatives of companies in the indus-
try they represent. Selecting stocks that will participate in an index requires considering a number of
criteria. Some of these are as follows:
  The quality of representation of the company in the industry segment to which the company
belongs
  How much less the impact cost is when a transaction on this stock is executed
  The liquidity of the stock on the exchanges on which it is listed and traded
  The stock holding pattern—how widely the stock is held
Normally, the 80-20 rule applies here, meaning 20 percent of the stocks usually represent 80
percent of the market capitalization. So, a handful of about 30–50 stocks are selected. Which stocks
are selected and what criteria was used is public domain information; you can get it for any index
from the exchange/index owner. With about 30 stocks, their market capitalizations are added up to
arrive at the market capitalization of the entire market. Thus, the market capitalization of an entire
market (assuming 30 stocks have been selected) for the creation of an index is as follows (where market
capitalization equals i):
Σ i = 1 to 30
Since an index is a relative measure of market capitalization, the current market capitalization
is compared to the market capitalization of a selected base year. And usually 100 is taken as the
starting point of the index. Using this concept, you can arrive at a number. Thus, the index is as follows:
(Current market capitalization / Average market capitalization in the base year) * 100
So, when you read that some index is at 4,000, it means the market capitalization of that partic-
ular market has gone up 40 times compared to the market capitalization of the base year. Note that
you divide 4,000 by 100 in this interpretation because you multiplied the index by 100 to start. It is
not compulsory that all indexes are multiplied by 100, though; it depends upon the calculation used
from index to index.
If the index adds 100 points in one day and moves from 4,000 to 4,100, it means that the relative
market capitalization has gone up from 40 times to 41 times. In other words, it means the market
has added the kind of worth in one day that is equal to its total worth during the base year. The base
year that is chosen for computing the index whose market capitalization is used as a benchmark is
one where the markets were relatively stable and were not characterized by a bull or bear run. The
average market capitalization is public domain information and can be calculated/obtained from
the exchange/index owner.
Since market capitalization uses the current market prices of stocks and these prices change
every second, the index changes every second. With the previous formula of the index and all other
factors being constant, you can now compute the effect of change in an index with a change of prices
in any security dollar by dollar.14C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
Clearing Corporations
A stock exchange is an interesting market. Traders enter into hundreds of thousands of transactions
with other traders without settling them immediately. They simply trust that other traders/members
will honor their purchases and sale commitments. In reality, with such a complex web of transactions,
any default could start a chain of defaults and could prove catastrophic. Therefore, a clearing corpora-
tion settles all trades executed in a stock exchange. In this section, we will first cover the importance
of the role played by clearing corporations, and then we will cover how a clearing corporation functions.
Even with differences in opinion about the value of a security, trades will happen only when
the parties involved in the trade are comfortable with each other, especially on the front of financial
soundness. When members transact with each other, they need to believe their trade commitments
will be honored. Large institutions would otherwise shy away from trading with smaller traders if they
perceive the risk that small traders will not honor their commitments. Advanced exchanges have
thousands of members. Even assuming 1,000 members, there could be 999,000 potential trading
relationships. It is not possible for each member to verify the financial stability of the others before
they enter into a trade, especially on an ongoing basis. The costs associated with this verification
would be immense, and this would make markets very illiquid. In a market that does not foster
confidence, few will come forward to trade.
Clearing corporations take on the onus of doing credit checks on each member. They lay down
capital adequacy guidelines and make the members adhere to them. They provide exposure limits on
the amount of collateral collected from members. This collateral is in the form of cash, fixed deposits,
and bank guarantees. In addition to this collateral, clearing corporations ask for day-to-day margins,
which are commensurate to the positions that members take on a daily basis. The position limits of
members are monitored closely. Margin calls are made to members who the clearing corporation
thinks can endanger the financial integrity of the overall market. In the event of a member breach-
ing his limits, the clearing corporation immediately recommends disconnecting the trading facility
for that particular member until the member brings additional collateral.
Most clearing corporations identify only members. They don’t identify a member’s customers
and don’t maintain personal- and trading-related data for a member’s customers. However, in reality
it is a member’s customers who place the majority of orders on any exchange. Just as the clearing
corporation takes responsibility of verifying the credit worthiness of its members, it leaves the veri-
fication of credit worthiness of end customers to its members. Members by and large use the same
concept of asking for margins and collateral from their customers to cover their risks, and they in
turn validate a customer’s exposure vis-à-vis collateral and margins submitted.
Running credit checks only does not suffice, though. What if a member or customer defaults
after all the precautions have been taken? A member might not put in fresh trades, but adverse
price changes could result in severe losses and could make him a defaulter. In addition to having
stringent credit checks, clearing corporations also guarantee transaction settlement through the
concept of novation, discussed in detail in Chapter 2.
The level of guarantee that clearing corporations provide goes a long way in providing peace
of mind to institutions and large investors, so much so that now most trading is anonymous. This
means that while trading on a screen-based system, traders don’t even know who they are trading
with. With novation, they know that legally, their counterparty is the clearing corporation itself,
and in case the counterparty defaults, the clearing corporation will make their losses good.
Every exchange usually hooks up with one or more clearing corporations to settle its trades.
The clearing corporation normally levies a small fee and builds a corpus of funds over a period of
time to provide this kind of guarantee. This fund is normally called a trade guarantee fund. Some
even buy insurance policies to cover this kind of default risk.
Every member of the exchange either has a clearing agreement with one of the members of
a clearing corporation or directly holds membership in the clearing corporation. Members of a clearing
corporation settle either their own trades or the trades of other trading members. One trading mem-
ber who is a member of a clearing corporation may sometimes choose to route trades through other
clearing members because they have reached their clearing limits.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 15
For trades executed on the NYSE, the National Securities Clearing Corporation (NSCC) acts as
the clearing corporation and guarantees and settles transactions between market professionals and
ensures sellers are paid and buyers receive their securities in a manner that reduces risk, cost, and
post-trade uncertainties.
Since losses arising from becoming a central counterparty could be huge, clearinghouses pay
a lot of attention to the credit quality of members. They also pay a lot of attention to the settlement
risks faced by the clearing corporation from time to time. Risk is also controlled by the imposition
of margins from members in correlation to the position they hold in the market at any given point
of time.
We will now discuss how settlement takes place in brief and cover it in detail in subsequent
sections. At the end of every trading period (also known as the settlement period), the clearing corpo-
ration arrives at figures relating to every member’s obligation toward the clearing corporation and the
clearing corporation’s obligation toward the members. The members deliver securities and cash to
discharge their obligations at the time of pay-in and receive money from the clearing corporation at
the time of pay-out. Cash is interchanged through the banking channel, and securities are moved
through demat accounts. This entire process is called settlement.
In terms of technology and capacity, clearing corporations must be able to handle average vol-
umes but also peak volumes, such as the market could have witnessed after the September 11 disaster.
Any shortfall in handling capacity could potentially doom the entire financial market, which in turn
would become a catalyst to its demise.
Banks
Banks play two roles. Some banks are designated as clearing banks with whom members of a clear-
ing corporation open clearing accounts. All settlement between the clearing member and clearing
corporation relating to funds happens through debit and credit in this account only.
Investors and traders also maintain bank accounts, and fund-related settlements happen from
these bank accounts. It is never mandatory for the investor and broker to have accounts in the same
bank. Having a swift and robust banking infrastructure is highly desirable to enable initiatives such
as STP and T+1 settlements. (STP and T+1 are marketwide initiatives to reduce the settlement period.
We will discuss these in detail in subsequent sections of this chapter.) If transferring money from one
account to another is enabled only through conventional methods such as checks and takes three
days to clear, how can market participants honor their monetary obligations within one day or two
days as stipulated by the T+1 and T+2 regimes? A lot of study and changes are being made/suggested
in the banking sector so that it can meet this kind of challenge.
Banks play a crucial role in enabling online trading. Members enable online trading by providing
a browser-based interface. Such members hook up with banks where investors are asked to open
accounts. For any buy order that the investor places through the Internet, the trading system routes
the order to the bank, which in turn debits the investor’s account to the extent of the value of shares
purchased. Investors are required to maintain either a separate account or a normal account where
the bank holds a power of attorney to debit the client’s account.
Depositories
A depository can be compared to a bank for shares. Just as a bank holds cash in your account and pro-
vides all services related to transactions of cash, a depository holds securities in electronic form and
provides all services related to transactions of equity shares, debt instruments, or other securities.
A depository plays an important role in settling transactions. To increase their reach, just like
banks, depositories have accredited agencies that represent them. In many countries, members of
the clearing corporation themselves become agencies of the depository and provide brokering as
well as depository services to their customers. In other countries, the agency is called a depository
participant. Apart from brokers, banks and financial institutions also become depository partici-
pants. The Depository Trust Corporation (DTC) is the largest depository in the world.16C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
An investor requiring depository services has to approach the member or the depository par-
ticipant to open an account. The investor has to fill out an account opening form and fulfill some
documentation requirements. Once the documentation is complete, the agency interacts with the
depository and opens the account. The investor is given an account number, which he has to pro-
vide for reference for all future transactions. Shares are then kept in electronic form in this account
just like money is kept in the form of electronic credits in any bank account.
The type of accounts depositories have vary from country to country. Two types of accounts are
found in most depositories:
  A beneficiary account is an account held by an investor. As the name suggests, this type of
investor enjoys all the benefits that accrue to him as a virtue of being a shareholder. These
benefits include price appreciation and benefits arising from corporate actions such as divi-
dends, bonuses, rights issues, and so on, declared on the stocks held in the beneficiary account.
  A clearing member account is held by a clearing member and used for facilitating settlements.
This account works as a conduit, and shares flow from investors into this account and from
this account to clearing corporations for pay-in, and vice versa for pay-out.
Worldwide depositories operate on a variety of architectures. Some hold the details of an investor’s
accounts, including details of the shares held. Others maintain details at the agency level and require
that agencies maintain the details of investors and investor accounts. Some depositories use a hybrid
model, meaning they hold details about the holdings of an investor and also make it mandatory for
agencies to hold the same information. Though this setup means redundancy in data, at times it may
be a good approach if the connectivity between the depository and the agency is not reliable or the
depository is untested and is working in a relatively new environment.
The kind of transactions that depositories support varies from country to country and from
market to market. Some common types of transactions in every market are as follows:
Off-market transfer: As the name suggests, these are transfers that are not backed by any market
transactions on the exchange. These are transfers from one beneficiary account to another.
A friend giving shares to another friend or a husband moving shares from his account to his wife’s
account is an example of off-market transfers where no market buying/selling is involved. This
type of transfer usually takes place in large corporate deals such as acquisitions and stake sales
where shares are transferred from one corporate entity to another.
Market transfers: These are transfers that result from the purchase/sale of transactions in the
market (read: exchange). An investor doing a sale transaction, for example, will have to go to
the depository agency and give an instruction to debit his account and credit the account of
the broker through which the transaction was conducted. Similarly, if he has done a buy trans-
action and the broker has received securities in his account on behalf of the investor, the broker
will have to give a debit instruction to debit his account and credit the account of the investor.
Interdepository transfers: This is the transfer of securities from one account in one depository
to another account maintained in another depository. Depositories normally maintain connectiv-
ity with each other for these kinds of transactions, and such transactions take place as a batch
process at one time or at multiple times during the day.
Pledge: An investor holding securities can pledge his securities in favor of someone to raise
money or for any other reason. The securities that have been pledged cannot be transferred.
When the term of the pledge expires or when both parties agree, the pledge can be closed, and
the securities are again moved to the free balance. Once securities move to the free balance, they
can be transferred freely.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 17
Most of these instructions are tagged with an execution date. When the investor/broker gives
a debit or credit instruction, they also specify when the transfer has to take place. The depository
conducts the transfers on that particular date. All transactions within the depository can be executed
instantaneously. All transfers that happen are irrevocable in nature, which means that once the
transfer is complete, it cannot be transferred back without the consent and signature of the recipient.
Note that a risk is associated with a debit instruction from any investor’s account. Hence, it is
mandatory that investors include their signatures and expressly give all debit instructions. Credit
instruction has no such risk. The investors are required to give a standing instruction once, and then
all credits will flow automatically into their account. This method reduces the number of instructions
flowing to the depository and provides convenience to investors. An analogy of this is a bank where
you need to write a check to get your account debited, but for any credits coming in, you don’t give
any instructions. The credit just flows in. Institutions, however, don’t use this facility much. They also
keep a check on what securities are flowing into their accounts. Hence, they expressly give instructions
for crediting their accounts.
Most brokers make investors sign a power of attorney. They use this power of attorney to generate
debit instructions automatically on behalf of the investors for sale transactions they do on behalf of
the investors. This saves an investor’s time and effort, considering the strict timelines imposed for
meeting T+2 settlements.
Depositories perform millions of such transfers daily. Apart from the transfers, depositories also
safely keep shares. Instead of keeping their shares with themselves, investors hold them in a depository
and don’t risk losing them. Depositories also keep track of corporate actions and facilitate in providing
benefits of these corporate actions to investors. For all these services, depositories levy a small fee. The
agencies of depositories with which the investors interact increase these charges to levy their own charges.
Having shares in a dematerialized form is a prerequisite for T+1 and T+2 settlements. This elimi-
nates the risk of bad deliveries to a large extent and provides a lot of operational convenience. It was
not unusual during the physical certificate days to see truckloads of certificates being brought to
a clearing corporation for the delivery of large orders. Imagine the effort it took for the clearinghouse
to count, sort, and redistribute those shares to the buyers. In all, it used to take a lot of time and effort.
In the depository system, the ownership and transfer of securities takes place by means of electronic
book entries. At the outset, this system rids the capital market of the dangers related to handling paper.
This system provides a lot of other benefits too:
Elimination of risks associated with physical certificates: Dealing in physical securities has the
associated security risks of theft of stocks, mutilation of certificates, loss of certificates during
movements through and from the registrars (thus exposing the investor to the cost of obtaining
duplicate certificates and advertisements), and so on. This risk does not arise in the depository
environment.
Some governments exempt stamp-duty requirements for transferring any kind of securities
in the depository. This waiver extends to equity shares, debt instruments, and units of mutual
funds.
Immediate transfer and registration of securities: In the depository environment, once the secu-
rities are credited to the investor’s account on pay-out, the investor becomes the legal owner of
the securities. The investor has no further need to send the security to the company for regis-
tration. Having purchased securities in the physical environment, the investor has to send it to
the company’s registrar so that the change of ownership can be registered. This process is cum-
bersome and takes a lot of time.
Faster settlement cycle: Markets could offer T+3, T+2, and so on—down from T+5—because
dematerialized mode enables faster turnover of stock and more liquidity with the investor.
Having discussed various important entities, we will now provide a brief overview of how
a typical trade life cycle moves from the order initiation phase to the final settlement phase.18C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
Exploring the Life Cycle of a Trade
In this section, we will show how an order flows from an investor to an exchange, how it gets converted
into a trade, and how it gets settled. Each order that is initiated by an investor follows a defined life
cycle from initiation to settlement (see Figure 1-6). This life cycle is defined worldwide by the exist-
ing operational practices of most institutions, and the processes are more or less similar. The emphasis
is on getting the orders transacted at the best possible price and on getting trades settled with the
least possible risk and at manageable costs. Designated employees in the member’s office ensure
that each trade that takes place through them or in their house account gets settled properly. Unsettled
trades lead to liability, risk, and unnecessary costs.
Figure 1-6. Life cycle of a trade: schematic view
The following steps are involved in a trade’s life cycle:
1. Order initiation and delivery
2. Risk management and order routing
3. Order matching and conversion into trade
4. Affirmation and confirmation (this step is relevant for institutional trades only)
5. Clearing and settlement
Steps 1 and 3 are generally called front-office functions, and steps 4–5 are called back-office
functions. The risk management part in step 2 is a middle-office function, and the routing part is
again a front-office function. In the trading and settlement value chain, steps that take place beforeC H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 19
the order gets executed are called pre-trade. These include order initiation, order delivery, order
management and routing, order-level risk management, and so on. Similarly, steps that take place
after the order is matched and converted into a trade are called post-trade. The entire gamut of
clearing and settlement is known as post-trade activity.
We will cover each of these steps in detail in the following sections. Though the underlying
philosophies of executing orders at the lowest costs and performing risk-free settlements remain
the same, the operational steps differ from member to member and also from country to country.
Also, given an institution, the steps followed differ from client to client. This is actually more linked
to the client type rather than to the client. An individual person trading is classified as a retail customer
and is hence considered risky. Corporate customers, funds, banks, and financial institutions are
called institutional investors. For example, risk management before order routing may be a step that
takes place compulsorily for a retail client but could be waived for an institutional client, especially
if the institution has a sound financial standing in the market. Additional steps are involved in settling
an institutional trade in comparison to a retail trade. This difference is because institutions normally
outsource their settlement function, and members have to talk to this additional agency. Institutions
also have a number of checks and balances that each member has to follow.
Order Initiation and Delivery
This is the first step, and it involves accepting orders from a client and forwarding them to the
exchange after doing risk management checks.
Clients keep a close eye on the markets and keep scouting for investment opportunities. They
form a view about the market. View alone, however, is not enough to produce profits. Profits come
from maintaining a position in the market. Positions are the results of trades that investors execute
in the markets. Clients place orders with their brokers through multiple delivery channels. Some
popular channels for placing orders include phones, faxes, the Internet, and interactive voice response
systems (IVRSs). The majority of brokers have built-in capabilities to allow clients to submit their
orders through personal digital assistants (PDAs) and other handheld devices. Institutions usually
place a large number of orders. Most institutions submit their orders in soft-copy format through
a floppy disk or any other bulk-upload medium.
Those who trade a lot in a particular market may even demand that the broker gives them
a dedicated trading terminal. They may also set up their own trading terminal that connects to the
broker’s trading terminal/server through a proprietary protocol or industry-standard protocol such
as Financial Information Exchange (FIX), which is a technical specification prepared in collabora-
tion with brokers, exchanges, banks, and institutional investors to enable the seamless exchange of
trading information between their systems. Systems with broker and trading institutions generate
orders automatically depending upon the market conditions. Trading on such automatically gener-
ated orders is called program trading and is not allowed in some markets because it is perceived to
cause volatility. Regardless of the methodology used for order delivery, the broker carefully records
the orders so that there is no ambiguity or mistakes in processing. Almost all brokers record the
conversation between clients and brokers, which can be used later for dispute resolution in case
any ambiguity exists over what was communicated and what was interpreted and executed.
Institutions normally speak to a sales desk of the broker and get a feel for the market. An insti-
tution or the fund manager who places the order may be managing multiple funds. At the time of
placing the order, however, the fund manager may not know to which fund he will allocate the secu-
rities bought/sold. At the point of placing the order, the fund manager just instructs the sales desk
of the broker to execute the order.
An individual order received from a client is tagged with some special conditions such as good
till cancelled (GTC), good till date (GTD), limit order, market order, and so on. These conditions
dictate the rate and condition at which the customer expects the orders to be executed. (We will
discuss these conditions in more detail in Chapter 2.) The member on a best-effort basis accepts the
order. Unless an institution specifically demands it, there is no standard practice of giving back-order20C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
confirmation details. This essentially means that the clients work with brokers on good faith that the
broker has understood their order terms clearly and will get it executed at the best possible price. It
is important that brokers preserve the sanctity of the conditions specified and get the orders executed
within the boundaries of specification. Failure to do so will result in the client moving to a different
brokerage house.
■Note Reputation is far more important than any other attribute in this business. Institutions like brokers who
get their orders executed at the best possible prices and save them money. Standard methodologies are available
for institutions to measure the performance of brokers.
Risk Management and Order Routing
Regardless of how an order gets generated or delivered, it passes through a risk management matrix.
This matrix is a series of risk management checks that an order undergoes before it is forwarded to
the exchange. We discussed earlier that the onus of getting the trades settled resides with the broker.
Any client default will have to be made good to the clearing corporation by the broker. Credit defaults
are thus undesirable from the point of view of the broker who puts money and credibility on the line
on behalf of the customer. Hence, these credit and risk management checks are deemed necessary.
Institutions are normally considered less risky than retail customers. That is because they have
a large balance sheet compared to the size of orders they want to place. They also maintain a lot of
collateral with the members they push their trades through. Their trades are hence subjected to
fewer risk management checks than retail clients.
The mechanisms followed when orders are accepted and sent to exchanges for matching are the
same for both institutions and retail clients. However, for retail customers the orders are subjected to
tighter risk management checks and scrutiny. The underlying assumption in all such risk management
checks is that retail clients are less credit worthy and hence more susceptible to defaulting than
institutions. A recent extension of retail trading has been trading through the Internet. This exposes
brokers to even more risk because the clients become faceless. In the good old days of “call and trade”
(receiving orders by phone), most brokers executed transactions of clients they knew. With the
advancement in trading channels, the process of account opening became more institutionalized,
and the numbers came at the expense of client scrutiny. Most brokers who operate on behalf of retail
clients these days operate on the full-covered concept. This means that while accepting orders from
retail clients, they cover their risks as much as possible by demanding an equal value of cash or near
cash securities.
We’ll briefly cover how a retail transaction is conducted so you can understand the benefit
provided by risk management. The method utilized is more or less the same in call and trade as in
Internet trading. The order delivery mechanism changes, but the basic risk management principle
implemented remains the same. Here are the steps:
1. The client calls the broker to give the orders for a transaction (in Internet trading the client
logs on to the Internet trading site, provides credentials, and enters orders).
2. The broker validates that the order is coming from a correct and reliable source.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 21
3. In case the client gives a buy order, the broker’s system makes a query to ascertain whether
the client has enough balance in a bank account or in the account the client maintains with
the broker. In case the client does not have enough balance, the order is rejected even before
forwarding to the exchange. If the client has the balance, the order is accepted, but the value
of the order is deducted from the client’s balance to ensure that he does not send a series of
orders for which he cannot make an upfront payment. Many brokers still do not have direct
interfaces to a banking system. In such cases, they ask the client to maintain a deposit and
collateral in the form of cash and other securities; they keep the ledger balances of a client’s
cash and collateral account in their back-office system and query this system while placing
the order to ensure that the client has enough money in his account (see Figure 1-7).
4. In case a client gives a sell order, the broker checks the client’s custody/demat account to
ensure that he has a sufficient balance of securities to honor the sale transaction. Short sell-
ing is prohibited in most countries, and brokers need to ensure that the client is not short of
securities at the time of settlement, especially in markets that do not have an adequate stock-
lending mechanism in place. Most markets have an auction mechanism in place for bailing
out people with short positions, but such bailouts could be very expensive. Once the sale
transaction is executed, the broker keeps a record and updates the custody balance’s system
if it is in-house or keeps reducing the figures from the figures returned by the depository to
reflect the client’s true stock account position. In many countries, brokers have a direct
interface with the depository system that lets them query the amount of shares of a particular
company in which the client has balances. Wherever a direct interface is absent, the broker
maintains the figures in parallel; the broker then does a periodic refresh of this data by upload-
ing the figures provided by the depository and maintains a proper intraday position by debiting
figures in his system when the clients give sale orders that are executed on the exchange
(see Figure 1-8).
Figure 1-7. Buy orders of retail clients are usually validated against the amount held in the
bank/account with the broker.
Figure 1-8. Sell orders are validated against the stock balance held by the client in the
custody/demat account.22C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
5. Once the risk management check passes, the client’s order is forwarded to the exchange.
6. On receipt of the order, the exchange immediately sends an order confirmation to the broker’s
trading system.
7. Depending upon the order terms and the actual prices prevailing in the market, the order
could get executed immediately or remain pending in the order book of the exchange.
You can appreciate the role technology plays when you consider that the entire process of
receiving the order, doing risk management checks, forwarding the order to the exchange, and get-
ting back the confirmation is expected to take a few hundredths of a second. Any performance not
conforming to this standard is considered unacceptable and could be a serious reason for clients to
look for other brokers who can transact faster and get them more aggressive prices.
One of the ways of implementing risk management is through margining. A margin is an amount
that clearing corporations levy on the brokers for maintaining positions on the exchange. The amount
of margin levied is proportional to the exposure and risk the broker is carrying. Since positions may
belong to a broker’s clients, it is the broker’s responsibility to recover margins from clients. Margins
make the client stand by trades in case the market goes against the client by the time the trades get
settled.
Let’s examine this concept using an example: Suppose a client purchased 1,000 Microsoft
shares at $45 per share. The total amount needed to be paid to the clearing corporation at the time
of settling the transaction is $45,000. But this is payable only after two days of executing the transac-
tion. This is because in most markets there is a lag of two days between executing the transaction and
finally settling it. Assume on the next day of transacting—that is, T+1—there is adverse news about
Microsoft that causes the stock price to drop 10 percent. The client would see an erosion of $4,500
straight from his account if he has to honor the position. The client would have a strong incentive to
default in this transaction merely by not showing up to the broker to make the payment. To protect
the market from such defaulters, clearing corporations levy margins on the date of the trade. Margins
are computed and applied to a client’s position in many ways, but the underlying philosophy of
levying margins is to tie the customer to a position and preserve the integrity of the market even if
a large drop in stock prices occurs.
Order Matching and Conversion into Trade
All orders are aggregated and sent to an exchange for execution. Chapter 2 explains the entire process
of order matching in detail. Stock exchanges follow defined rules for matching all the orders they
receive. While protecting the interests of each client, the exchange tries to execute orders at the best
possible rates. The broker’s trading system communicates with the exchange’s trading system on
a real-time basis to know the fate of orders it has submitted.
A broker keeps a record of which orders were entered during the day, by whom, and on behalf
of which client. A broker also maintains details of how many orders were transacted and how many
are still pending to be executed. Using this system, a broker can modify the order and order terms,
cancel the order, and also split the order if required depending upon the behavior of the market and
instructions from the clients. Once the order is executed, it gets converted to a trade. The exchange
passes the trade numbers to the broker’s system. The broker in turn communicates these trade
details to the client either during the day or by the end of the day through a contract note or through
an account activity statement. The contract note is a legal document that binds the broker and the
client. Contract note delivery is a legal requirement in many countries. Apart from the execution
details, the contract note contains brokerage fees and other fees that brokers levy for themselves or
collect on behalf of other agencies such as the clearing corporation, exchange, or state.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 23
Affirmation and Confirmation
This step is present only when the trading client is an institution. Every institution engages the services
of an agency called a custodian to assist them in clearing and settlement activities (see Figure 1-9).
As the name suggests, a custodian works in the interest of the institution that has engaged its services.
Institutions specialize in taking positions and holding. To outsource the activity of getting their
trades settled and to protect themselves and their shareholder’s interests, they hire a local custodian
in the country where they trade. When they trade in multiple countries, they also have a global custo-
dian who ensures that settlements are taking place seamlessly in local markets using local custodians.
As discussed earlier, while giving the orders for the purchase/sale of a particular security, the
fund manager may just be in a hurry to build a position. He may be managing multiple funds or
portfolios. At the time of giving the orders, the fund managers may not really have a fund in mind in
which to allocate the shares. To avoid a market turning unfavorable, the fund manager will usually
give a large order with the intention of splitting the position into multiple funds. This is to ensure
that when he makes profits in a large position, it gets divided into multiple funds, and many funds
benefit.
The broker accepts this order for execution. On successful execution, the broker sends the trade
confirmations to the institution. The fund manager at the institution during the day makes up his
mind about how many shares have to be allocated to which fund and by evening sends the broker
these details. These details are also called allocation details in market parlance. Brokers then prepare
the contract notes in the names of the funds in which the fund manager has requested allocation.
Along with the broker, the institution also has to liaise with the custodian for the orders it has
given to the broker. The institution provides allocation details to the custodian as well. It also pro-
vides the name of the securities, the price range, and the quantity of shares ordered. This prepares
the custodian, who is updated about the information expected to be received from the broker. The
custodian also knows the commission structure the broker is expected to charge the institution and
the other fees and statutory levies.
Using the allocation details, the broker prepares the contract note and sends it to the custodian
and institution. In many countries, communications between broker, custodian, and institutions are
now part of an STP process. This enables the contract to be generated electronically and be sent
through the STP network. In countries where STP is still not in place, all this communication is manual
through hand delivery, phone, or fax.
Figure 1-9. Affirmation and confirmation process24C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
On receipt of the trade details, the custodian sends an affirmation to the broker indicating
that the trades have been received and are being reviewed. From here onward, the custodian initi-
ates a trade reconciliation process where the custodian examines individual trades that arrive from
the broker and the resultant position that gets built for the client. Trades are validated to check the
following:
  The trade happened on the desired security.
  The trade is on the correct side (that is, it is actually buy and not sell when buy was specified).
  The price at which the trade happened is within the price range specified by the institution.
  Brokerage and other fees levied are as per the agreement with the institution and are correct.
The custodian usually runs a software back-office system to do this checking. Once the trade
details match, the custodian sends a confirmation to the broker and to the clearing corporation that
the trade executed is fine and acceptable. A copy of the confirmation also goes to the institutional
client. On generation of this confirmation, obligation of getting the trade settled shifts to the custo-
dian (a custodian is also a clearing member of the clearing corporation).
In case the trade details do not match, the custodian rejects the trade, and the trades shift to
the broker’s books. It is then the broker’s decision whether to keep the trade (and face the associated
price risk) or square it at the prevailing market prices. The overall risk that the custodian is bearing
by accepting the trade is constantly measured against the collateral that the institution submits to
the custodian for providing this service.
Clearing and Settlement
With hundreds of thousands of trades being executed every day and thousands of members get-
ting involved in the entire trading process, clearing and settling these trades seamlessly becomes
a humungous task. The beauty of this entire trading and settlement process is that it has been taking
place on a daily basis without a glitch happening at any major clearing corporation for decades. We
discussed earlier that apart from providing a counterguarantee, one of the key roles of a clearing
corporation is getting trades settled after being executed. We will now cover in brief how this entire
process works.
After the trades are executed on the exchange, the exchange passes the trade details to the
clearing corporation for initiating settlement. Clearing is the activity of determining the answers to
who owes the following:
  What?
  To whom?
  When?
  Where?
The entire process of clearing is directed toward answering these questions unambiguously.
Getting these questions answered and moving assets in response to these findings to settle obliga-
tions toward each other is settlement (see Figure 1-10). Thus, clearing is the process of determining
obligations, after which the obligations are discharged by settlement. It provides a clean slate for
members to start a new day and transact with each other.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 25
Figure 1-10. The clearing corporation computes the obligations for every member arising from trades
and communicates it to members as a first step toward settlement.
When members trade with each other, they generate obligations toward each other. These obli-
gations are in the form of the following:
  Funds (for all buy transactions done and that are not squared by existing sale positions)
  Securities (for all sale transactions done)
Normally, in a T+2 environment, members are expected to settle their transactions after two days
of executing them. The terms T+2, T+3, and so on, are the standard market nomenclature used to
indicate the number of days after which the transactions will get settled after being executed. A trade
done on Monday, for example, has to be settled on Wednesday in a T+2 environment.
As a first step toward settlement, the clearing corporation tries to answer the “what?” portion
of the clearing problem. It calculates and informs the members of what their obligations are on the
funds side (cash) and on the securities side. These obligations are net obligations with respect to the
clearing corporation. Since the clearing corporation identifies only the members, the obligations of
all the customers of the members are netted across each other, and the final obligation is at the member
level. This means if a member sold 5,000 shares of Microsoft for client A and purchased 1,000 shares
for client B, the member’s net obligation will be 4,000 shares to be delivered to the clearing corporation.
Because most clearing corporations provide novation (splitting of trades, discussed in more detail
in Chapter 2), these obligations are broken into obligations from members toward the clearing
corporation and from the clearing corporation toward the members. The clearing corporation com-
municates obligations though its clearing system that members can access. The member will normally
reconcile these figures using data available from its own back-office system. This reconciliation is
necessary so that both the broker and the clearing corporation are in agreement with what is to be
exchanged and when.
In an exchange-traded scenario, answers to “whom?” and “where?” are normally known to all
and are a given. “Whom?” in all such settlement obligations is the clearing corporation itself. Of course,
the clearing corporation also has to work out its own obligations toward the members. Clearing
members are expected to open clearing accounts with certain banks specified by the clearing cor-
poration as clearing banks. They are also expected to open clearing accounts with the depository.
They are expected to keep a ready balance for their fund obligations in the bank account and similarly
maintain stock balances in their clearing demat account. In the questions on clearing, the answer to
“where?” is the funds settlement account and the securities settlement account.
The answers to “what?” and “when?” can change dramatically. The answer to “when?” is provided
by the pay-in and pay-out dates. Since the clearing corporation takes responsibility for settling all
transactions, it first takes all that is due to it from the market (members) and then distributes what
it owes to the members. Note that the clearing corporation just acts as a conduit and agent for settling
transactions and does not have a position of its own. This means all it gets must normally match all
it has to distribute.26C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
Two dates play an important role of determining when the obligation needs to be settled. These
are called the pay-in date and the pay-out date. Once the clearing corporation informs all members
of their obligations, it is the responsibility of the clearing members to ensure that they make available
their obligations (shares and money) in the clearing corporation’s account on the date of pay-in,
before the pay-in time. At a designated time, the clearing corporation debits the funds and securities
account of the member in order to discharge an obligation toward the clearing corporation. The
clearing corporation takes some time in processing the pay-in it has received and then delivers the
obligation it has toward clearing members at a designated time on the date of pay-out. It is generally
desired that there should be minimal gap between pay-in and pay-out to avoid risk to the market.
Earlier this difference used to be as large as three days in some markets. With advancement in tech-
nology, the processing time has come down, and now it normally takes a few hours from pay-in to
pay-out. Less time means less risk and more effective fund allocation by members and investors.
The answer to “when?” is satisfied by the pay-in and pay-out calendar of the clearing corporation,
which in turn is calculated depending upon the settlement cycle (T+1, T+2, or T+3).
Answers to “what?” depend on the transactions of each member and their final positions with
respect to the exchange. Suppose a member has done a net of buy transactions; he will owe money
to the clearing corporation in contrast to members who have done net sell transactions, who will
owe securities to the clearing corporation. To effect settlements, the clearing corporation hooks up
with banks (which it normally calls clearing banks) and depositories. It has a clearing account with
the clearing bank and a clearing account with the depository as well. A clearing bank account is used to
settle cash obligations, and a clearing account with a depository is used to settle securities obligations.
Funds Settlement
Funds settlement is relevant for all buy transactions that are not netted off by offsetting the sale
transaction. This is required because brokers have to pay for all the securities they have purchased.
For funds settlement, every broker is required to open a clearing account with a clearing bank
designated by the clearing corporation. The broker then needs to ensure that he parks the required
amount, as specified in funds obligation by the clearing corporation, in the clearing account before
the pay-in.
For obligations arising because of transactions done by the client, the broker has to collect money
from the client. Hence, the following takes place:
1. For a buy transaction, the client issues a check-in favor of his broker or pays money through
other acceptable payment channels.
2. The broker calculates (and also receives as a notice from a clearing corporation) his total
monetary obligation and deposits money accordingly in the clearing account. (Since this
deposit is a routine activity, he normally keeps a deposit in the clearing account much like
a current account, and the clearing corporation keeps debiting and crediting his account
depending upon whose obligation is toward whom. The clearing corporation also pays
money to the clearing member in case a member is a net seller of securities; in this case,
the money is the sale proceeds of the member.)
3. The clearing corporation debits this clearing account by the amount of money required to
meet the settlement obligation at the time of pay-in. As discussed in the previous step, if the
obligation is in favor of the broker, the clearing corporation credits the broker’s clearing account
during pay-out.
In case a client has sold securities and needs to be paid, the broker will issue a check after receiving
the money from the clearing corporation during pay-out.
All funds obligation is therefore managed by debiting and crediting this clearing account. Moving
money from and to this account rarely takes place through checks these days. Standard banking
interfaces and electronic funds movement channels move money from one account to another.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 27
Also note that the clients can be based in a city that is different from where the broker has a clearing
account. Clients are not required to deposit checks directly in the clearing account. They submit their
checks locally to the broker’s office, and the broker’s staff can deposit the check in a local branch or
forward it to the head office. As discussed earlier, all money required to meet the obligation has to
reach the clearing account by T+2 in a T+2 settlement regime. This makes keeping large working capital
necessary. In some countries, brokers have special arrangements with their banks to treat money in
the local branch accounts as money in the clearing account and will honor the clearing request made
by the clearing corporation as long as the sum of all money in such accounts is more than the demand
made by the clearing corporation. They also have the facility to move this money swiftly, often on an
intraday or next-day basis, so that such obligations can be met.
With funds settlement, settlement is only partially complete. Even the securities side has to be
settled for settlement to be complete.
Securities Obligation
All efforts are directed toward ensuring that the clearing corporation receives the shares before the
pay-in time. Just like a broker maintains a clearing account for funds with a designated clearing
bank, brokers are required to maintain a clearing account for securities with the depository. At the
time of pay-in, the clearing corporation just puts its hands in this clearing account and takes whatever
has been placed there for meeting the securities obligation.
The clearing account for the securities of a broker can be logically divided into three parts, as
shown in Figure 1-11.
Whatever securities the broker is required to deliver to meet his pay-in requirements move to
the delivery account. Note that the existence of a delivery account is logical only in theory. Hence,
there is no movement of shares per se. What actually happens is that brokers give special instructions
earmarking securities for pay-in. It is an express statement that authorizes the clearing corporation
to pick up these shares and use them toward the discharge of a broker’s obligation. This express state-
ment is necessary because at the time of pay-in, the broker may have a large reserve of securities in
his pool account that may not be meant for delivery, and all such securities need to be ignored while
picking up the securities.
Just like funds obligation arises from purchase transactions, securities obligation arises from
sale transactions of a client. To discharge this obligation, clients need to move securities from their
accounts to the clearing corporation accounts. They do this using a three-step process:
1. The client gives a debit instruction in his account and credits the broker’s securities account
with the required number of shares. With completion of this step, the shares move from the
client’s securities account to the broker’s pool account.
2. The broker marks these securities for pay-in and moves them logically from his pool account
to the delivery account.
3. At the time of pay-in, the clearing corporation takes all the securities in the delivery account
to discharge the broker’s securities obligation.
Figure 1-11. Logical breakdown of a securities clearing account28C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
Figure 1-12. Settlement comprises pay-in and pay-out.
This, however, does not complete settlement. Note that the broker could also be a buyer of
some securities. He will receive these securities in his receipt account during pay-out. This receipt
account is also a logical account. The shares will actually reside in the pool account itself, but they
will be properly classified as “received in pay-out for a particular settlement.”
For the settlement of securities that clients have purchased through a broker, the broker gives
a debit instruction in his securities account favoring the client. As a result, shares move from the
broker’s account to the client’s account. A broker will move shares to the client’s account after the
client has paid for the purchase. Figure 1-12 illustrates this process.
Transactions are thus called settled when both the funds part and the securities part are settled.
This provides traders with a clean slate to trade afresh without worrying about the consequences of
trades they did in the past. Settlements ensure that their transactions have reached finality and that
the benefits of executing the transactions will accrue to them.
After understanding the basics of how transactions are executed and settled, you will now explore
another important aspect, STP. STP plays an important role in getting all the participants together
in a way that good synergy is achieved and that the operational time, risk, and cost of getting this
entire cycle from order initiation to settlement is automated.
Exploring the Precursor to Straight Through
Processing (STP)
To understand STP, you need to understand the concepts of the front office, middle office, and back
office (see Figure 1-13). These are, role-wise, the segregation in a member’s office or trading institution’s
office. The front office is responsible for trading. In a broker’s office, the front office speaks to various
customers and solicits business. The front-office staff is also responsible for managing orders and
executing them. The back-office staff is responsible for settling transactions. The back office ensures
that all obligations toward the clearing corporation are met seamlessly and that the member receives
its share during pay-out. While this entire process is happening, the middle office monitors all limitsC H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 29
and exposures, and thus risks, that the firm is assuming. The middle office is also responsible for
reporting, especially where corporate-level reporting is required. Since a broker’s office is organized
into front, middle, and back offices, solution providers structure their products in the same fashion
in the form of modules. Although many vendors provide solutions for all three sections, it is not
mandatory for a broker to buy all three modules from the same vendor. If a broker goes for different
vendors, though, then they have an issue of intermodule communication. Most brokers want all the
three modules to be integrated. If they are not, then data will have to be entered multiple times in
these modules. To obviate from this problem, brokers rely on a concept called STP (see Figure 1-14).
STP, as defined by the Securities Industry Association (SIA), is “...the process of seamlessly pass-
ing financial information to all parties involved in the transaction process, spanning the investment
manager decision through to reconciliation and statement production, without manual handling or
redundant processing in real time.”
Two types of STP exist: internal and external. In the case just discussed, internal STP is required
because you need to connect modules installed in a broker’s office. But some other entities such as
custodians, fund managers, and so on, play an equally important role in settlement. To achieve true
STP, even these need to be connected to each other. Any attempt to connect such entities beyond
the organization in pursuit of STP is called external STP. We will lay the foundation for STP in this
section and discuss some related but advanced concepts in Chapters 6 and 7.
The industry wants to put processes in place that will allow an order to flow right from deal
entry to conversion to trade to affirmation and confirmation and finally through settlement and
accounting without manual intervention. This is because the industry wants to move toward T+1
settlement. This means trades done on one day will get settled the next day. This is an ambitious
plan because it will call for a lot of process change, technology change, and industry change. Appli-
cations will have to come together and orchestrate the entire business process.
STP provides a lot of benefits to industry participants:
Figure 1-13. Front, middle, and back offices
Figure 1-14. Conceptual view of STP
www.allitebooks.com30C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
  STP reduces settlement time. This essentially reduces risk because transactions will be settled
faster and will be irrevocable. Settlements are said to be irrevocable when they are considered
to be final and cannot be reversed. Reduced settlement time also means better utilization of
capital.
  Less manual intervention will mean fewer operational risks and errors. It will also mean
fewer costs.
  STP will force the entire industry to move toward standard communication protocols. This
will mean standardized systems and fewer system development and maintenance costs.
Interoperability will be a prerequisite for this to happen; we will go into depth about this in
Chapter 7.
  Increased automation will lead to increased throughput in transaction processing, thereby
enabling institutions to achieve greater transaction volumes.
Equity trading and STP by itself are vast subjects, and understanding every minute business
detail in a single go is not possible; furthermore, the functioning of every stock exchange is different
from one another (though the concepts are fairly standard). We hope you by now understand the
importance of financial markets, why equities are issued, and how they are traded and settled. We
will discuss STP concepts in more detail in Chapters 6 and 7. You should also be in a position to
understand the various entities in a financial system relating to equities trading and settlement.
Understanding .NET in an Equities Market
Figure 1-6 clearly demonstrates the amount of business complexity involved in achieving end-to-
end automation. To technically realize this entire business case, you need a rock-solid technology
platform that is capable of providing an intelligent solution to various aspects of the business. In the
equities market, we broadly categorize business functionality in the form of the front office, middle
office, and back office. The target audiences of this business are different, and obviously their
expectations from the system are different. For instance, front-office systems are highly performance-
oriented, and the audience using them demands an instant response. Front-office systems are (near)
real-time systems, and their core responsibility is to open new business opportunities by providing
the correct information at the correct time. On the other hand, back-office systems are database
oriented and somewhat relaxed in terms of real-time performance. Back-office systems are the
information backbone of the organization and provide a strong reporting and regulatory compliance
feature. Similarly, middle-office systems are designed for managing risk and are used by both front-
office and back-office systems. Performance is important in all phases of a trade’s life cycle, but
a tolerance factor determines to what extent systems can bend and lends itself to quirks and rapid
changes in market conditions. In the front-office system, the tolerance factor needs to be absolutely
low, but the same may not be true for back-office systems.
Figure 1-15 depicts the technology stack used in the pre-.NET days to implement front-office,
middle-office, and back-office functionality. C/C++ stands out as the most favorable candidate in
designing front-office systems, and the primary reason behind such a decision is the multitude of
resources offered by the language. C/C++ offers a broad range of programming features to equip
developers so they can deal with all spectrums of programming such as the operating system, graphical
user interface, network, multithreaded programming, and so on. Back-office systems are designed
using rapid application development (RAD) tools such as Visual Basic and are backed with extremely
powerful relational database management systems (RDBMSs) such as SQL Server or Sybase. Finally,
a middle-office system’s implementation varies and is mainly driven by the business requirement.
If a lot of analytics are involved that require complex mathematical calculation, then Microsoft Excel
is the primary programming tool.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 31
Figure 1-15. Pre-.NET days
There is no doubt that when performance forms the key factor to success of the trading business,
then C/C++ is used. C/C++ has both a bright side and a dark side. The dark side is the time-consuming
coding tasks and hard-to-detect memory leaks faced in a production environment. Some good inte-
grated development environments (IDEs) are available to bring down the development time to some
extent, but they never meet a developer’s satisfaction. Despite all these problems, you must appreciate
that Microsoft is always full of new ideas.
For example, Microsoft introduced the Component Object Model (COM) technology with an aim
of revolutionizing the Microsoft programming world. COM architecture heavily promoted reusability
among Microsoft programming languages, which in turn opened the door for implementing a new
hybrid programming approach, as depicted in Figure 1-16. The performance-critical code was
developed in C++ and happily exposed to the outside world as COM components. The consumers
of these components could be any COM-aware programming language. The organization started
devising a new strategy in which the majority of tasks were implemented using RAD tools, and only
the small portion that is performance sensitive is implemented in C/C++ and exposed as COM
components. This in turn increased developer productivity and promoted faster development time.
But such language monogamy among Microsoft products was not striking enough to face the
competition from its rivals, and with business complexities growing day by day Microsoft clearly needed
a deeply integrated programming model. This is where .NET came to the rescue (see Figure 1-17).
Figure 1-16. COM days
Figure 1-17. .NET days32C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
Innovation is the culmination of an individual’s imagination, and .NET innovation is the culmi-
nation of the “Redmondian” imagination. It filled many of the gaps and also answered many of the
key decisions in determining the platform selection. The whole programming model was revisited
and reengineered from the ground up, giving birth to the common language runtime (CLR). The CLR
is a modern run-time system and welcomes developers into a new “managed world” where managed
code is written in a managed language and executed in a managed environment. The CLR provides
the execution environment and other core services to managed code that form one of the strong
foundations in designing a robust and secure application.
.NET as a language offers rich programming features and also overcomes most of the deficiencies
that were evident in the earlier Windows programming languages. Because of this, .NET gave impe-
tus to major financial organizations to look at their business realms and reconsider their decisions
and investments. .NET clearly provides all the features of a good programming language:
Automatic garbage collection: Trading-related applications usually fall prey to memory-related
problems, and diagnosing such leaks is every programmer’s nightmare. Even though one of the
basic tenets of programming is to allocate resources when required and reclaim the memory
when it is not required, this is an explicit step that a programmer needs to strictly follow. Although
most programmers follow this discipline religiously, as with all human endeavors, mistakes tend
to creep in. .NET relieved developers from battling these memory leaks by introducing nonde-
terministic garbage collection. Programs written in .NET completely depend upon garbage
collection, which uses a heuristics-based algorithm to reclaim memory from unused or unreach-
able resources. It is also nondeterministic because the timing of performing garbage collection
is not determined and comes into action when memory pressure is felt, finally freeing up memory
space.
Deployment: The ease of deploying applications is considered to be one of the key attributes in
determining the adaptability of applications. Deployment was extremely painful during the COM
days; with advent of .NET, this task is made extremely simple by embracing the XCOPY-style
deployment approach. The only prerequisite required to execute .NET-based applications is the
.NET Framework; after installing the framework, developers or users can install .NET applications
simply by copying the binaries.
Openness: With .NET, Microsoft has entered into community development for the first time,
breaking the long-standing wall between consumers and producers. This is made possible by
outlining a specification known as the Common Language Infrastructure (CLI). The specifica-
tion defines everything from execution environment to metadata information that would enable
anyone to build a concrete implementation. The .NET Framework itself adheres to this specifi-
cation. To encourage community participation, Microsoft released Shared Source CLI, popularly
known as Rotor, which basically is a spin-off from the original .NET Framework. Shared Source
CLI contains source code that provides a deep understanding of the language infrastructure.
Platform neutrality: Applications written in .NET are no longer limited to the Windows platform;
they can be targeted on any platform as long as the underlying execution runtime is available
and adheres to the CLI standard. Mono (http://www.go-mono.com) is one of the successful imple-
mentations of CLR available for the Linux platform.
Security: In the olden days, application security was always an afterthought. But with the advent
of .NET, the equation has changed; security is given important consideration and is baked into
every aspect of the framework. Security is branched into two forms: code access security and
data security. Code access security is all about protecting resources based on the identity and
origin of the code. This is in contrast to data security, which is used to enable secure message
exchange using various cryptographic algorithms.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 33
Interoperability: The base framework in .NET provides most of the features required for day-to-day
operation. However, it still falls short of some of the functionality available in the Win32 world.
The same applies to the COM technology. .NET provides backward compatibility and allows
seamless integration with legacy COM components or Win32 DLLs by using the Platform-Invoke
(P/Invoke) API. This will motivate organizations to migrate to this new platform without losing
the investment done on legacy code.
Business-to-business integration: The next big wave in software development is connecting
various heterogeneous systems deployed in an organization. The biggest problems faced are
integration and interoperability between systems; to resolve these issues, you need a platform
that connects this system and takes advantage of investments made in existing systems. .NET
heavily promotes this goal by providing unconditional and unstinted support to Web services–based
development. Web services are the implementation backbone and vehicle for connecting sys-
tems using industry-established open standards and protocols.
Language rich: .NET is language rich. Currently, more than 20 programming languages are
available, and such an influx of languages completely eliminates the steep learning curve required
for an individual. Organizations can smoothly mobilize their development forces based on the
favored in-house programming language. For example, if COBOL is the most suitable language
for the organization’s software automation, then the developers can use COBOL.NET.
Handheld computing: The .NET Compact Framework is a slim version of the .NET Framework
that facilitates the development of applications targeted for handheld and mobile devices. The
overall resource bandwidth in handheld devices is limited and hence needs to be judiciously
utilized. Considering this resource limitation, Microsoft shipped Compact Framework, which is
optimized for both the time and space dimensions of an application. Even though not all features
of the .NET Framework are available in the Compact Framework, the available class hierarchy
is inline with .NET Framework classes. This provides a smooth learning curve and transition for
any developer who wants to develop programs for handheld devices.
Productivity: Visual Studio .NET 2003/2005 is a full-blown IDE that offers RAD, deployment and
packaging, versioning, debugging, IntelliSense help, dynamic help, and many more features
that help to increase software development productivity. Furthermore, the VS .NET IDE is fully
extensible to allow developers to automate most common routine daily tasks by packaging them
inside macros. Macros are .NET-based executables written in VB .NET or C# but are designated
to execute inside the IDE shell.
Community support: You can gauge the growing popularity of .NET by the amount of contribution
from the open source development community. . NET introduced a new posture toward the open
source initiative by encouraging thousands of developers around the globe to develop open source
applications based on the .NET Framework. This support is further backed by the strong com-
munity support available in the form of blogs and newsgroups.
Academic research: .NET has not only gained success in the commercial world but has also
stretched its wings into academic research. Popular universities now consider .NET a part of
their course curriculums. Several new research projects are also underway. Such solid commit-
ments will further help reshape the future of .NET-related technologies.
Development methodology: .NET has emerged as a leading platform that makes software quality
endeavors much simpler to implement. With .NET, most of the manual development processes
are automated, thereby infusing discipline into every stage of the software life cycle. This automation
has resulted in higher productivity and fewer software defects.34C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
Potentiality: With the industry already moving toward a 64-bit computing initiative, there is
heavy demand for the 64-bit CLR. As of this writing, Microsoft has already floated a 64-bit CLR
designed to work with Windows 2003 64-bit editions. There is virtually no rework involved in
moving the existing 32-bit versions of .NET applications, and the existing managed code base
can be migrated to the 64-bit CLR with little or no change.
So far we have discussed only the most important features of .NET. We will discuss several other
important aspects of .NET in subsequent chapters.
What Is a Techno-Domain Architect?
An architect is a creator who crafts the destiny of a vision or a goal, and a software architect is no dif-
ferent from a civil architect in this aspect. When it comes to the final objective, a software architect’s
ultimate mission is to provide a strong foundation. It is important for a civil architect to build a strong
base for constructing a building. If the foundation is weak, it will create a devastating effect and even
risk lives. The same analogy applies to a software architect; a loose foundation will shake the business
of an organization. As the first person to enter the application development arena, the software
architect’s primary role is to understand the requirements of the organization and apply the appro-
priate technology mix that is best suited for the organization.
In today’s world where every area of computer science has seen many forms of growth and
given the depth and breadth of current technologies, it is extremely challenging to keep abreast of
all these aspects. It is virtually impossible to achieve mastery over all areas. To keep pace with growing
technologies, software architects have started to specialize in various forms, including as enterprise
architects, security architects, infrastructure architects, interoperability architects, information architects,
and so on. As their names suggest, each architect’s roles and responsibilities are clearly defined,
which in turn helps to clearly articulate their technical strengths.
Techno-domain architects can be considered as one of the branches of the software architect
tree. Unlike architects from other branches whose core focus is sharpening only technical skills,
a techno-domain architect has excellent command over both the domain and the technology. Such
specialized architects are limited in number because people’s skill sets are usually one-sided: a per-
son is specialized either in the hard-core technology or in the business aspects of the domain. Thus,
a techno-domain architect is a vertical specialist who has gathered tremendous knowledge in a par-
ticular niche area by designing and executing real-life systems and in the process assimilated both
the nutrients of the system (that is, the domain knowledge and the underlying technology to realize
the business case).
Techno-domain architects are not meant to replace business analysts. Business analysts will
continue to play a key role in the requirements-gathering phase. Vertical specialists, with their knowledge
of the particular niche area, will help to strengthen the team as a whole.
Both technology and businesses change over a period of time. But changes in business are
frequent and are driven by changes in the external environment. Moreover, there is no longevity
associated with business; once a business feature is outdated, it carries no further value. However,
technology has an associated aging factor and is a slowly decaying process. Thus, keeping abreast of
both these aspects of a system is a challenging task for a vertical specialist.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 35
Understanding the Three I’s (Intelligence) of
Performance in Capital Markets
Performance is the mantra for all high-performance or mission-critical applications. This is generally
overlooked in small-scale applications where the number of users is limited and the number of trans-
actions conducted is relatively small. Performance goals in such small-scale applications are often
sidelined or considered only during the design phase, and no additional thought process is usually
invested subsequently. This is in direct contrast to mission-critical applications where performance is
given serious thought in every phase, is continuously refined, and is constantly evidenced in the form
of significant growth and improvement in the overall functioning of the system.
Efficiency of applications revolves around the following main objectives of performance:
Responsiveness: Responsiveness is measured by how fast the system reacts to a user request.
Latency: Latency is the quantum of time taken to get a response. Latency is usually high in
a networked application.
Throughput: Throughput is often measured during a peak time and depicts the application’s
full potential to handle the maximum load in a given amount of time.
Scalability: Scalability is often overstressed, but in reality it relates to the scaling of hardware
resources.
Several guidelines provide a wealth of information about how to achieve these objectives, and
even some best programming practices will elevate the performance of an application to a certain
level. However, remember that performance is an art and cannot be achieved by applying some
straightforward cookbook rules. You can achieve these goals only by closely evaluating the environ-
ment under which the application is sheltered and then applying the appropriate intelligence that
best suits the environment. In fact, sometimes techniques applied to boost performance in one
environment prove to be ill-suited for another environment.
In the financial world, performance holds center stage, and a lack of good performance is
a primary reason for discarding an existing application and then rebuilding it from scratch. It also
means that the performance of an application is tightly coupled with its underlying design. It is the
application’s design that is not capable of meeting the required quality of service that a typical busi-
ness demands. Also, such problems do not spring up immediately but become evident as time passes.
It also implies a direct relationship between design and time, as shown in Figure 1-18.
Figure 1-18. Relationship between an application’s design and timeFigure 1-19. The three levels of intelligence
In Figure 1-18, the lower rectangular bar represents time, and the upper bar represents design. On
the left, notice that until a certain point, design is completely in sync with time; however, design loses
track as the height of the design bar increases. This phase reflects a change in design either because
of a drastic change in the business requirement that was unwarranted at this stage of time or because
of some poor assumption based on which the design was realized and finally failed to meet the required
expectations. In the final stage, the design bar returns to its original shape and size, but notice that
the inner filling in the bar is shaded, which is different from the original bar. This indicates that the
old design has been completely scrapped, resulting in a completely new design. On the right, the design
is completely in sync with time and therefore considered to be a good design.
So, what makes a good design? Some audiences consider even a badly designed application
that has the potential to cater to a business expectation as a good design. Therefore, it is difficult to
provide a definition of good design; however, a good design is one that considers the three constel-
lations of time: past, present, and future. A rock-solid design must be designed from the past, designed
with the present, and designed for the future. It means a design must fill all the missing gaps in the
past, must handle all the current requirements, and must handle any future needs. In a nutshell,
a good design is a time traveler.
Although performance is an important aspect of design, you must consider another important
aspect: user requirements. At the end of the day, if the application fails to win customer hearts by
not meeting their business needs, it would still be considered a bad design even if it is free from any
architectural flaws. In the financial world, both performance and user requirements are key sensi-
tive areas. User requirements are expected to change, which is inevitable, but performance-related
issues are avoidable. In a broader sense, you can achieve good performance by applying the three
levels of intelligence in an application shown in Figure 1-19.
36C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
In fact, by mixing these three levels of intelligence in the right proportion, you can develop
a rock-solid application.
Machine Intelligence
Machine intelligence is inclined toward the programmatic perspective of an application. The best way
to implement this intelligence is by religiously following the best programming practices and apply-
ing well-proven architectural standards. The most common practices followed in high-performance
applications are applying parallelism, which is achieved using multithreading; devising a highly
optimized algorithm; and exploiting platform- or hardware-specific capabilities.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 37
Domain Intelligence
Domain intelligence goes hand in hand with machine intelligence. To apply such intelligence, the
team must be cognizant of both domain- and technology-specific details. When domain intelligence
is applied at the right place, it gives a multifold increase in the performance of the application. This
intelligence is often ignored during the performance-engineering phase of a system where a team’s
energy is primarily mobilized toward implementing all sorts of machine-level intelligence.
Let’s take a market data example where introducing domain intelligence along with machine
intelligence provides a tremendous performance boost: Market data applications broadcast the
latest price of a stock. Several consumers then process this information. These real-time prices are
often displayed on most financial Web sites. The price of stocks tends to lose tempo whenever there
is a swing in the market behavior. This swing period lasts for a short span of time, and during this
period almost every stock price is affected. This period is called a data-quake because the system
will notice a huge surge of data, and this sometimes may even lead to a system crash. Even if you
assume that the first line of defense is strong and the market data service is able to survive this data-
quake, remember that this information needs to further trickle down to the consumers; thus, the
consumers of this information could also face the same disaster.
So, how do you escape from such a deluge of data? Although no easy solution exists, you can
deal with this by applying domain-level intelligence. Before applying this intelligence, you need to
understand the business implication behind this data that will help control the flow of data. Let’s
say your investigation disclosed that most stock prices tend to change at least 100 times a second.
So, instead of pushing this change immediately to downstream systems, you can throttle it for a second.
During this throttling period, data will not be pushed; rather, it will undergo a price-replacement
process that will blindly override the old price of a stock with the new price. As data gets published
only after the expiry of 1 second, it effectively controls the flow of data from flooding the market
data ecosystems. Even though the first line of market data service will receive roughly about 100
messages per second for any given stock, this will not affect downstream systems because they will
receive throttled messages at the rate of one message per second.
Human Intelligence
Human intelligence is user-centric. This may come as a surprise; the question that is immediately
raised is, what type of contribution will users make toward improving the performance of the appli-
cation? To be more precise, it is not the performance specification from users but their postures
toward the system that will drive the performance of the application. You must follow the important
principle What-You-Ask-Is-What-You-Get (WYAIWYG) to provide users with what they demand
rather than what is merely provided by the system. For example, it does not make sense to paint the
user screen with thousands of orders that are far beyond the range of the human eyeball, even if the
system has the capacity to provide this. It is also important to keep a close eye on a user’s behavior
toward applications and also spend a fair amount of effort gathering this intelligence by spending
time with users and watching their screen interactions and mouse movements.
You can further optimize the market data service discussed in the earlier “Domain Intelligence”
section by infusing elements of human intelligence into it. You already know that any given stock
price is updated at least 100 times a second, and if the user has subscribed to 100 stocks, this would
result in the system processing 10,000 message per second. But in reality, the user may not view all
100 stocks but keep a watch over only a few volatile stocks. So, if the system temporarily suspends
subscribing to a stock that is not viewed by the user, then it would give a fair amount of breathing
space to system resources, which would in turn be less taxed and also effectively utilized. This clearly
explains the merit of applying human intelligence, which is often overlooked.Figure 1-20. The .NET Framework and solutions for the financial world
38C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T
Thus, it is important to apply both domain and human intelligence to extract every bit of per-
formance. Furthermore, it is also important to understand that a threshold factor is associated with
machine-level intelligence. After a certain level, you will have no room left for any kind of improvement,
and once you have exhausted this resource, the only alternative is to leverage the domain and human
intelligence in a balanced manner.
Introducing the Upcoming Business Cases
The rest of the chapters in this book elaborate on business cases that play important roles in the trad-
ing life cycle. Individual chapters cover both domain and technology know-how in specific areas. The
implicit theme of each chapter is to provide insight into the practical day-to-day challenges posed by
domain-specific issues and how you can address these issues using the .NET technology. The motive
of this book is to deeply explore the .NET Framework base class library (BCL).
The .NET Framework BCL is an exhaustive collection of reusable types that facilitates the faster
development of applications (see Figure 1-20). The BCL arms you with the ability to develop nearly
all kinds of applications spanning from GUI-based to (near) real-time applications. It is impossible
to explore this library in one gulp. Hence, the next step will be to cover some of the important libraries
and their immediate counterparts in the business world. The primary goal of this exercise is to pro-
vide theoretical insight into .NET and its practical applications and discuss solutions to challenges
faced in the real world.
The following are the areas that will be covered in depth in subsequent chapters:
Order-matching engine (collections and threading): The order-matching engine satisfies the quest
for moving toward a centralized order book. Order matching represents the exchange-side
process that receives orders from different sources, and based on various parameters associated
with an individual order, it performs a matching process. Chapter 2 discusses the important data
structures and threading features available as part of the BCL and demonstrates their usability
by showing how to build a simple-to-use order-matching engine.
Data conversion engine (XML): It is well-known that in spite of advances in technology, the
communication of information using flat files is still prevalent and considered to be one of the
most reliable vehicles for packaging and delivering information to the final end system. Chapter 3
recognizes this and addresses the issue usually encountered in systems where information
originates from different sources, particularly flat files, instead of data entered by a data-entry
operator. File import and export activity are commonly encountered in a settlement system
where various kinds of data are required for reporting purposes. Such systems are flooded with
data import and export code, so Chapter 3 discusses the need for a generic conversion framework
and also designs one using XML.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 39
Broadcast engine (sockets): A broadcast engine is the heart of a trading system. The main goal
of a broadcast engine is to publish the best asking and offer prices prevailing in the exchange.
However, this doesn’t restrict using a broadcast engine to only market data; it can also be used
in implementing other types of trading broadcasts. The most important aspect that needs serious
thought in realizing this engine is the timely delivery of data. Furthermore, a large number of
users would be using this data, and users are also geographically distributed. Chapter 4 covers
the .NET socket programming domain and shows how you can leverage it to build a simple-to-use
broadcast engine.
Application-monitoring engine (remoting): A trading system is built upon several individual
subcomponents. Each subcomponent is physically distributed on a separate machine and shares
a particular piece of task. In such an environment, it is important to manage and monitor the
task of all subcomponents from one central location. An application-monitoring engine is tasked
with this responsibility of hosting the individual subcomponents and periodically monitoring
the activity. Chapter 5 discusses how to create an application-monitoring engine using .NET
Remoting as an underlying infrastructure for managing the subcomponents of an application.
STP security (data security): Security is a key concern for all market participants, and its imple-
mentation remains the greatest challenge in the current vulnerable markets. In an STP space
where interaction among business participants cross organizations and geographic boundaries,
it is important to have the proper mechanisms in place to ensure the legitimacy of a business
participant and also shield the confidentiality of business transactions. Chapter 6 covers cryp-
tography and discusses various security measures that you can implement to achieve both internal
and external STP.
STP interoperability (Web services): Chapter 7 is geared toward the implementation of external STP
where the goal is to bring entities such as the broker, fund manager, and clearing corporation
under one common roof in pursuit of achieving T+1. Chapter 7 will explore the Web services
platform and the WS-* standards in achieving integration and interoperability among different
entities.
Equity arbitrage engine (CodeDOM): With millions of data packets hitting a system every second
and price ticks being revised tens of times every second, evaluating scenarios and generating
orders automatically are challenges for all solution providers. Chapter 8 talks about leveraging
automated code generation and how you can use it in designing a simple rule-based arbitrage
system.
Each chapter provides insight into how you can address issues confronting the financial markets
using the .NET Framework BCL. This means we will deal with every aspect of .NET in its proper con-
text by explaining how it is applicable to real-life business cases. Interweaving both domain and
technology aspects in every chapter will further solidify your understanding of the class library by
specializing it to the specific needs of a business. Finally, at the end of this book, we will give overview
of .NET 2.0 and explain some of the important features that further solidify .NET as a complete
end-to-end technology platform.C H A P T E R 1 ■ I N T R O D U C I N G T H E E Q U I T I E S M A R K E T 39
Broadcast engine (sockets): A broadcast engine is the heart of a trading system. The main goal
of a broadcast engine is to publish the best asking and offer prices prevailing in the exchange.
However, this doesn’t restrict using a broadcast engine to only market data; it can also be used
in implementing other types of trading broadcasts. The most important aspect that needs serious
thought in realizing this engine is the timely delivery of data. Furthermore, a large number of
users would be using this data, and users are also geographically distributed. Chapter 4 covers
the .NET socket programming domain and shows how you can leverage it to build a simple-to-use
broadcast engine.
Application-monitoring engine (remoting): A trading system is built upon several individual
subcomponents. Each subcomponent is physically distributed on a separate machine and shares
a particular piece of task. In such an environment, it is important to manage and monitor the
task of all subcomponents from one central location. An application-monitoring engine is tasked
with this responsibility of hosting the individual subcomponents and periodically monitoring
the activity. Chapter 5 discusses how to create an application-monitoring engine using .NET
Remoting as an underlying infrastructure for managing the subcomponents of an application.
STP security (data security): Security is a key concern for all market participants, and its imple-
mentation remains the greatest challenge in the current vulnerable markets. In an STP space
where interaction among business participants cross organizations and geographic boundaries,
it is important to have the proper mechanisms in place to ensure the legitimacy of a business
participant and also shield the confidentiality of business transactions. Chapter 6 covers cryp-
tography and discusses various security measures that you can implement to achieve both internal
and external STP.
STP interoperability (Web services): Chapter 7 is geared toward the implementation of external STP
where the goal is to bring entities such as the broker, fund manager, and clearing corporation
under one common roof in pursuit of achieving T+1. Chapter 7 will explore the Web services
platform and the WS-* standards in achieving integration and interoperability among different
entities.
Equity arbitrage engine (CodeDOM): With millions of data packets hitting a system every second
and price ticks being revised tens of times every second, evaluating scenarios and generating
orders automatically are challenges for all solution providers. Chapter 8 talks about leveraging
automated code generation and how you can use it in designing a simple rule-based arbitrage
system.
Each chapter provides insight into how you can address issues confronting the financial markets
using the .NET Framework BCL. This means we will deal with every aspect of .NET in its proper con-
text by explaining how it is applicable to real-life business cases. Interweaving both domain and
technology aspects in every chapter will further solidify your understanding of the class library by
specializing it to the specific needs of a business. Finally, at the end of this book, we will give overview
of .NET 2.0 and explain some of the important features that further solidify .NET as a complete
end-to-end technology platform. applications and also spend a fair amount of effort gathering this intelligence by spending
time with users and watching their screen interactions and mouse movements.
You can further optimize the market data service discussed in the earlier “Domain Intelligence”
section by infusing elements of human intelligence into it. You already know that any given stock
price is updated at least 100 times a second, and if the user has subscribed to 100 stocks, this would
result in the system processing 10,000 message per second. But in reality, the user may not view all
100 stocks but keep a watch over only a few volatile stocks. So, if the system temporarily suspends
subscribing to a stock that is not viewed by the user, then it would give a fair amount of breathing
space to system resources, which would in turn be less taxed and also effectively utilized. This clearly
explains the merit of applying human intelligence, which is often overlooked. mit order, market order, and so on. These conditions
dictate the rate and condition at which the customer expects the orders to be executed. (We will
discuss these conditions in more detail in Chapter 2.) The member on a best-effort basis accepts the
order. Unless an institution specifically demands it, there is no standard practice of giving back-order . One trading member who is a member of a clearing corporation may sometimes choose to route trades through other
clearing members because they have reached their clearing limits. day, and they allow all members to log in and trade during this

